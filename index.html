<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Primary Meta Tags -->
    <title>Discover trendy Events easily | Upcoming Events in Kathmandu | Khojum.com</title>
    <meta name="title" content="Discover trendy Events easily | Upcoming Events in Kathmandu | Khojum.com">
    <meta name="description" content="Nepal's top event discovery platform. Browse upcoming concerts, cultural festivals, art exhibitions, and entertainment in Kathmandu and beyond. Find the latest events happening today and tomorrow.">
    
    <!-- Keywords - include all relevant event categories and locations -->
    <meta name="keywords" content="events in kathmandu, nepal events, concerts in kathmandu, cultural events nepal, art exhibitions kathmandu, entertainment kathmandu, today's events kathmandu, upcoming events nepal, festivals kathmandu, live music nepal, theater shows kathmandu, comedy shows nepal, workshops kathmandu, seminars nepal, food festivals kathmandu, sports events nepal, khojum events">
    
    <!-- Additional SEO Meta Tags -->
    <meta name="robots" content="index, follow, max-image-preview:large">
    <meta name="googlebot" content="index, follow">
    <link rel="canonical" href="https://khojum.com">
    
    <!-- Language and Locale -->
    <meta name="language" content="English">
    <meta property="og:locale" content="en_US">
    <meta property="og:locale:alternate" content="ne_NP">

    <!-- Structured Data for Events -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "name": "Khojum Events",
        "url": "https://khojum.com",
        "potentialAction": {
            "@type": "SearchAction",
            "target": "https://khojum.com/search?q={search_term_string}",
            "query-input": "required name=search_term_string"
        }
    }
    </script>

    <!-- Dynamic Structured Data for Events -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "ItemList",
        "itemListElement": [
            {
                "@type": "Event",
                "name": "Example Event 1",
                "description": "Description of event 1",
                "startDate": "2024-03-21T19:00",
                "endDate": "2024-03-21T22:00",
                "location": {
                    "@type": "Place",
                    "name": "Venue Name",
                    "address": {
                        "@type": "PostalAddress",
                        "addressLocality": "Kathmandu",
                        "addressRegion": "Bagmati",
                        "addressCountry": "NP"
                    }
                },
                "image": "https://khojum.com/assets/images/event1.jpg",
                "offers": {
                    "@type": "Offer",
                    "price": "1000",
                    "priceCurrency": "NPR"
                }
            }
            // Add more events dynamically
        ]
    }
    </script>

    <!-- Site Verification -->
    <meta name="google-site-verification" content="your-verification-code">
    
    <!-- Mobile Optimization -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <meta name="theme-color" content="#dc143c">
    
    <!-- Existing favicon and other meta tags -->
    <link rel="icon" type="image/x-icon" href="/assets/logo/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/logo/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/logo/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/logo/favicon-16x16.png">
    
    <!-- Open Graph Meta Tags for better social sharing -->
    <meta property="og:title" content="Discover trendy Events easily | Upcoming Events in Kathmandu | Khojum.com">
    <meta property="og:description" content="Nepal's top event discovery platform. Browse upcoming concerts, cultural festivals, art exhibitions, and entertainment in Kathmandu and beyond.">
    <meta property="og:image" content="/assets/logo/og-image.png">
    <meta property="og:url" content="https://khojum.com">
    <meta property="og:type" content="website">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Discover trendy Events easily | Khojum.com">
    <meta name="twitter:description" content="Nepal's top event discovery platform. Browse upcoming concerts, cultural festivals, art exhibitions, and entertainment in Kathmandu.">
    <meta name="twitter:image" content="/assets/logo/twitter-card.png">
    
    <!-- Additional SEO Meta Tags -->
    <meta name="theme-color" content="#dc143c">
    <link rel="canonical" href="https://khojum.com">
    <meta name="robots" content="index, follow">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?fami~ly=Mukta:wght@300;400;600;700&family=Playfair+Display:ital,wght@0,500;0,700;1,500&display=swap" rel="stylesheet">
    <style>
        :root {
            --nepal-red: #dc143c;
            --nepal-blue: #003893;
            --accent-yellow: #f9d949;
            --dark-text: #333333;
            --light-text: #666666;
            --lightest-bg: #f9f7f5;
            --card-bg: #ffffff;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Mukta', sans-serif;
            line-height: 1.6;
            color: var(--dark-text);
            background-color: var(--lightest-bg);
            padding: 0;
            margin: 0;
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        header {
            background-color: var(--nepal-red);
            color: white;
            padding: 20px 0;
            position: relative;
            overflow: hidden;
        }
        
        header::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M50 25L70 45L50 65L30 45L50 25Z' fill='rgba(255,255,255,0.05)'/%3E%3C/svg%3E");
            background-size: 100px;
            opacity: 0.2;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .logo a {
            text-decoration: none;
            color: inherit;
        }
        
        .logo h1 {
            font-family: 'Mukta', sans-serif;
            font-size: 2.5rem;
            font-weight: 700;
            margin: 0;
        }
        
        .logo span {
            color: var(--accent-yellow);
        }
        
        .logo img {
            width: 50px;
            height: auto;
        }
        
        .title-section {
            text-align: center;
            padding-bottom: 30px;
        }
        
        .title-section h2 {
            font-family: 'Playfair Display', serif;
            font-size: 2.8rem;
            font-weight: 700;
            margin-bottom: 10px;
            line-height: 1.2;
        }
        
        .title-section p {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .date-display {
            font-family: 'Playfair Display', serif;
            font-style: italic;
            font-size: 1.3rem;
            font-weight: 500;
            margin-top: 10px;
            display: block;
        }
        
        .filter-bar {
            background-color: white;
            padding: 15px 0;
            border-radius: 0 0 10px 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            margin-bottom: 40px;
            position: relative;
            z-index: 10;
        }
        
        .filter-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }
        
        .filter-button {
            background-color: transparent;
            border: 1px solid var(--nepal-red);
            color: var(--nepal-red);
            padding: 8px 16px;
            border-radius: 100px;
            font-family: 'Mukta', sans-serif;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .filter-button:hover, .filter-button.active {
            background-color: var(--nepal-red);
            color: white;
        }
        
        .sort-dropdown {
            display: flex;
            justify-content: center;
            margin-top: 10px;
        }
        
        .sort-dropdown select {
            padding: 8px 16px;
            border: 1px solid var(--nepal-red);
            border-radius: 100px;
            background-color: transparent;
            color: var(--nepal-red);
            font-family: 'Mukta', sans-serif;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
        }
        
        .events-grid {
            display: grid;
            grid-template-columns: repeat(1, 1fr);
            gap: 25px;
            padding-bottom: 60px;
        }
        
        @media (min-width: 768px) {
            .events-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (min-width: 1024px) {
            .events-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        .event-image {
            position: relative;
            width: 100%;
            height: 200px; /* Fixed height for consistent image containers */
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            cursor: zoom-in;
            overflow: hidden; /* Ensure content stays within bounds */
        }
        
        .event-card {
            background-color: var(--card-bg);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
            display: flex;
            flex-direction: column;
        }
        
        .event-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
        }
        
        .event-category {
            position: absolute;
            top: 15px;
            right: 15px;
            background-color: var(--nepal-red);
            color: white;
            padding: 5px 12px;
            border-radius: 100px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .event-content {
            padding: 20px;
        }
        
        .event-title {
            font-family: 'Mukta', sans-serif;
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--dark-text);
            line-height: 1.3;
        }
        
        .event-meta {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .event-date, .event-time, .event-location, .event-price {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.9rem;
            color: var(--light-text);
        }
        
        .event-meta i {
            color: var(--nepal-red);
            font-size: 1rem;
        }
        
        .event-description {
            max-height: 150px; /* Adjust this value based on your needs */
            overflow-y: auto;
            padding-right: 10px;
            position: relative;
            scrollbar-width: thin;
            scrollbar-color: var(--nepal-red) #f0f0f0;
        }
        
        /* Scroll indicator */
        .scroll-indicator {
            position: absolute;
            bottom: 0;
            right: 0;
            background: linear-gradient(transparent, white);
            padding: 5px 8px;
            border-radius: 4px;
            font-size: 12px;
            color: var(--nepal-red);
            opacity: 0.8;
            pointer-events: none;
        }
        
        /* Custom scrollbar styles */
        .event-description::-webkit-scrollbar {
            width: 6px;
        }
        
        .event-description::-webkit-scrollbar-track {
            background: #f0f0f0;
            border-radius: 3px;
        }
        
        .event-description::-webkit-scrollbar-thumb {
            background: var(--nepal-red);
            border-radius: 3px;
        }
        
        .event-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: nowrap;
            margin-top: 10px;
        }
        
        .event-price-tag {
            font-weight: 700;
            font-size: 1.1rem;
            color: var(--nepal-blue);
            flex: 1;
            min-width: 100px;
        }
        
        .event-price-tag.free {
            color: #2ecc71;
        }
        
        .event-button {
            background-color: var(--nepal-red);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 100px;
            font-family: 'Mukta', sans-serif;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: background-color 0.2s ease;
            flex-shrink: 0;
            margin-left: 10px;
        }
        
        .event-button:hover {
            background-color: #b01030;
        }
        
        footer {
            background-color: var(--nepal-red);
            color: white;
            padding: 40px 0;
            text-align: center;
        }
        
        .logo-small {
            font-family: 'Mukta', sans-serif;
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 20px;
            display: inline-block;
        }
        
        .logo-small span {
            color: var(--accent-yellow);
        }
        
        .copyright {
            opacity: 0.8;
            margin-top: 20px;
            font-size: 0.9rem;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 40px 0;
        }
        
        .loading-spinner {
            border: 4px solid rgba(0,0,0,0.1);
            border-left: 4px solid var(--nepal-red);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @media (max-width: 768px) {
            .title-section h2 {
                font-size: 2.2rem;
            }
            
            .filter-buttons {
                justify-content: flex-start;
                overflow-x: auto;
                padding-bottom: 5px;
            }
        }
        
        /* Modal Styles */
        .modal {
            display: none; /* Hidden by default */
            position: fixed; /* Stay in place */
            z-index: 1000; /* Sit on top */
            left: 0;
            top: 0;
            width: 100%; /* Full width */
            height: 100%; /* Full height */
            overflow: auto; /* Enable scroll if needed */
            background-color: rgb(0,0,0); /* Fallback color */
            background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
        }
        
        .modal-content {
            background-color: #fefefe;
            margin: 15% auto; /* 15% from the top and centered */
            padding: 20px;
            border: 1px solid #888;
            width: 80%; /* Could be more or less, depending on screen size */
        }
        
        .close-button {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }
        
        .close-button:hover,
        .close-button:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }
        
        .countdown {
            display: inline-block;
            padding: 10px 15px;
            border: 1px solid var(--nepal-red);
            border-radius: 5px;
            background-color: white;
            color: var(--nepal-red);
            font-weight: bold;
            text-align: center;
            cursor: pointer;
        }
        
        .expired {
            color: red;
        }

        .sprinkle {
            position: absolute;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            pointer-events: none;
            opacity: 1;
        }

        .event-time-counter {
            margin-right: 10px;
            font-weight: bold;
            padding: 5px;
            border-radius: 8px;
            background-color: white;
            border: 2px solid var(--nepal-red);
            color: #aa2121;
        }
        .event-time-counter.upcoming {
            background-color: hwb(0 100% 0%);
            color: #dc143c;
        }
        .event-time-counter.happening {
            background-color: #e6ffe6;
            color: #006600;
        }
        .event-time-counter.expired {
            background-color: #ffe6e6;
            color: #cc0000;
        }

        .animated-holi-button {
            position: fixed; /* Fix the position */
            top: 20px; /* Distance from the top */
            right: 20px; /* Distance from the right */
            background-image: linear-gradient(45deg, #FF4136, #FF6B6B, #FFD700, #4ECDC4, #9D4EDD); /* Colorful gradient */
            color: rgb(5, 0, 0); /* Text color */
            padding: 12px 20px; /* Increased padding for a larger button */
            border: none; /* No border */
            border-radius: 20px; /* More rounded corners */
            font-size: 1rem; /* Increased font size */
            font-weight: bold; /* Bold text */
            text-decoration: none; /* No underline */
            transition: transform 0.2s ease, background-color 0.2s ease, box-shadow 0.2s ease; /* Shortened animation duration */
            z-index: 1000; /* Ensure it stays on top */
            animation: pulse 1.5s infinite; /* Add pulse animation */
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2); /* Added shadow for depth */
        }

        .animated-holi-button:hover {
            transform: scale(1.05); /* Slightly scale up on hover */
            background-image: linear-gradient(45deg, #FFD700, #FF6B6B, #4ECDC4, #9D4EDD, #FF4136); /* Change gradient on hover */
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3); /* Darker shadow on hover */
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05); /* Scale up */
            }
            100% {
                transform: scale(1); /* Scale back */
            }
        }

        #days-left {
            display: none; /* Hide the element */
        }

        .days-left-message {
            margin-left: 10px; /* Space between button and countdown message */
            font-size: 0.9rem; /* Font size */
            color: #333; /* Color to match your theme */
            font-weight: bold; /* Make it bold */
        }

        /* Media Queries for Mobile Responsiveness */
        @media (max-width: 768px) {
            .animated-holi-button {
                font-size: 0.8rem; /* Smaller font size for mobile */
                padding: 6px 12px; /* Smaller padding for mobile */
                top: 10px; /* Adjust position for mobile */
                right: 10px; /* Adjust position for mobile */
            }

            .days-left-message, .time-left-message {
                font-size: 0.8rem; /* Smaller font size for mobile */
            }
        }

        .support-message {
            font-size: 1rem; /* Increased font size for better visibility */
            color:  #ffcc00; /* Changed color for better contrast */
            margin-top: 4px; /* Add some space above */
            text-align: center; 
            margin-left: 10px;/* Center the text */
        }

        .email-link {
            color: #ffcc00; /* Updated link color */
            font-weight: bold; /* Make the link bold */
            text-decoration: underline; /* Underline the link for emphasis */
        }

        .email-link:hover {
            color: #3fc909; /* Change color on hover for visibility */
        }

        :root {
  --nepal-red: #c8102e; /* Nepal flag's crimson red */
  --nepal-blue: #003893; /* Nepal flag's deep blue */
  --calendar-background: #ffffff;
  --calendar-header: #003893; /* Using Nepal blue for header */
  --calendar-text: #333333;
  --calendar-inactive: #cccccc;
  --calendar-today: #e7f0f9;
  --calendar-selected: #c8102e; /* Using Nepal red for selected */
  --calendar-hover: #f0f0f0;
  --calendar-event-dot: #c8102e; /* Using Nepal red for event indicators */
  --calendar-border: #eeeeee;
  --calendar-shadow: rgba(0, 0, 0, 0.15);
}

/* Calendar Icon Button */
.calendar-icon {
  position: fixed;
  top: 20px;
  right: 20px;
  width: 60px;
  height: 60px; /* Increased height for better touchability */
  background-color: var(--nepal-red);
  border-radius: 12px; /* Slightly more rounded */
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  box-shadow: 0 3px 12px rgba(0, 0, 0, 0.25);
  transition: transform 0.2s, box-shadow 0.2s;
  z-index: 1000;
}

.calendar-icon:hover, .calendar-icon:active {
  transform: scale(1.05);
  box-shadow: 0 5px 18px rgba(0, 0, 0, 0.35);
}

.calendar-icon svg {
  width: 28px;
  height: 32px;
  fill: white;
  margin-bottom: -5px;
}

.calendar-label {
  font-size: 12px;
  font-weight: bold;
  color: white;
  text-align: center;
  margin-top: 4px;
}

/* Calendar Popup */
.calendar-popup {
  position: fixed; /* Changed to fixed for better mobile positioning */
  top: 140px;
  right: 20px;
  width: 320px; /* Slightly wider for mobile */
  max-width: calc(100vw - 40px); /* Ensures it doesn't overflow on small screens */
  background-color: var(--calendar-background);
  border-radius: 16px;
  box-shadow: 0 8px 30px var(--calendar-shadow);
  overflow: hidden;
  opacity: 0;
  visibility: hidden;
  transform: translateY(-10px);
  transition: opacity 0.3s, transform 0.3s, visibility 0.3s;
  z-index: 1000;
}

.calendar-popup.active {
  opacity: 1;
  visibility: visible;
  transform: translateY(0);
}

/* Calendar Header */
.calendar-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 16px;
  background-color: var(--calendar-header);
  color: white;
}

.month-year {
  font-weight: 700;
  font-size: 20px;
}

.nav-buttons {
  display: flex;
  gap: 12px;
}

.nav-btn {
  background: none;
  border: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px; /* Larger for better touch targets */
  height: 32px; /* Larger for better touch targets */
  border-radius: 50%;
  color: white;
  transition: background-color 0.2s;
}

.nav-btn:hover, .nav-btn:active {
  background-color: rgba(255, 255, 255, 0.25);
}

/* Calendar Toggle Styles */
.calendar-toggle {
  display: flex;
  align-items: center;
  justify-content: space-between; /* Changed to better space the elements */
  padding: 12px 16px;
  border-bottom: 1px solid var(--calendar-border);
}

.toggle-label {
  font-size: 14px;
  font-weight: 500;
  color: var(--calendar-text);
  margin-right: auto; /* Pushes it to the left */
}

.switch {
  position: relative;
  display: inline-block;
  width: 48px;
  height: 24px;
}

.switch input {
  opacity: 0;
  width: 0;
  height: 0;
}

.slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: #adabab;
  transition: .4s;
}

.slider:before {
  position: absolute;
  content: "";
  height: 18px;
  width: 18px;
  left: 3px;
  bottom: 3px;
  background-color: white;
  transition: .4s;
}

input:checked + .slider {
  background-color: var(--nepal-blue); /* Changed to match theme */
}

input:checked + .slider:before {
  transform: translateX(22px);
}

.slider.round {
  border-radius: 24px;
}

.slider.round:before {
  border-radius: 50%;
  
}

/* Calendar Grid */
.calendar-grid {
  padding: 14px;
}

.weekdays {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  text-align: center;
  font-weight: 600;
  color: #666;
  margin-bottom: 10px;
  font-size: 14px;
}

.days {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 4px;
  text-align: center;
}

.day {
  aspect-ratio: 1/1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  cursor: pointer;
  position: relative;
  font-size: 14px;
  color: var(--calendar-text);
  transition: background-color 0.2s;
  padding: 8px 0; /* Added padding for better spacing */
}

.day.event:after {
  content: '';
  position: absolute;
  bottom: 4px;
  left: 50%;
  transform: translateX(-50%);
  width: 5px;
  height: 5px;
  background-color: var(--calendar-event-dot);
  border-radius: 50%;
}

.day:not(.inactive):hover, .day:not(.inactive):active {
  background-color: var(--calendar-hover);
}

.day.today {
  background-color: var(--calendar-today);
  font-weight: bold;
}

.day.selected {
  background-color: var(--calendar-selected);
  color: white;
  font-weight: bold;
}

.day.inactive {
  color: var(--calendar-inactive);
  cursor: default;
}

.nepali-date {
  font-size: 18px;
  color: var(--nepal-red);
  margin-top: 2px;
  /* Added line height limiting for compact display */
  line-height: 1;
}

/* Events Panel */
.events-panel {
  background-color: #f9f9f9;
  border-top: 1px solid var(--calendar-border);
  padding: 12px 16px;
  max-height: 180px; /* Slightly increased height */
  overflow-y: auto;
}

.event-date {
  font-weight: 600;
  color: var(--nepal-blue);
  margin-bottom: 6px;
  font-size: 14px;
}

.event-list {
  list-style-type: none;
  padding: 0;
  margin: 0;
}

.event-item {
  padding: 8px 0;
  border-bottom: 1px solid var(--calendar-border);
  color: var(--calendar-text);
  font-size: 14px;
}

.event-item:last-child {
  border-bottom: none;
}

.no-events {
  color: #999;
  font-style: italic;
  font-size: 14px;
  padding: 8px 0;
}

/* Archived Events Button */
.archived-events-icon {
  position: fixed;
  bottom: 20px;
  right: 10px;
  background-color: var(--nepal-red);
  color: white;
  padding: 12px 16px;
  font-weight: bold;
  font-size: 14px;
  border-radius: 8px;
  text-decoration: none;
  display: flex;
  align-items: center;
  gap: 8px; /* Space between icon and text */
  box-shadow: 0 3px 12px rgba(0, 0, 0, 0.2);
  transition: background-color 0.3s, transform 0.2s;
  z-index: 1000;
}

.archived-events-icon:hover, .archived-events-icon:active {
  background-color: #a70d26; /* Slightly darker on hover */
  transform: scale(1.03);
}

.archived-events-icon svg {
  width: 16px;
  height: 16px;
  fill: white;
}

/* Media Queries for Mobile Responsiveness */
@media (max-width: 768px) {
  .calendar-popup {
    right: 50%;
    transform: translateX(50%) translateY(-10px);
    width: 90%;
    max-width: 350px;
  }
  
  .calendar-popup.active {
    transform: translateX(50%) translateY(0);
  }
  
  .calendar-icon {
    right: 15px;
    top: 15px;
  }
  
  .archived-events-icon {
    right: 15px;
    bottom: 15px;
    padding: 10px 14px;
    font-size: 13px;
  }
  
  .day {
    font-size: 13px;
  }
  
  .nepali-date {
    font-size: 14px;
  }
}

@media (max-width: 480px) {
  .calendar-grid {
    padding: 10px;
  }
  
  .weekdays {
    font-size: 12px;
  }
  
  .day {
    font-size: 12px;
  }
  
  .nepali-date {
    font-size: 16px;
  }
  
  .events-panel {
    max-height: 160px;
  }
}
        .archived-events-icon {
            position: bottom; /* Changed to fixed for consistent positioning */
            bottom: 20px; /* Adjusted for desired position */
            right: 20px; /* Adjusted for desired position */
            background-color: var(--nepal-red); /* Background color */
            color: white; /* Text color */
            padding: 10px 15px; /* Padding */
            font-weight: bold;
            border-radius: 5px; /* Rounded corners */
            text-decoration: none; /* Remove underline */
            display: flex; /* Flexbox for alignment */
            align-items: center; /* Center items vertically */
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2); /* Shadow for depth */
            transition: background-color 0.3s; /* Smooth background color transition */
            z-index: 1000; /* Ensure it stays on top */
        }

       

        .archived-events-icon:hover {
            background-color: #b01030; /* Darker shade on hover */
        }
        @media (max-width: 768px) {
  #fixedButton {
    top: 5px; /* Adjusted position for smaller screens */
    right: 5px; /* Adjusted position for smaller screens */
  }
}


        .icon-box {
            display: flex; /* Flexbox for icon and text */
            align-items: center; /* Center items vertically */
        }

        .icon-box i {
            margin-right: 7px; /* Space between icon and text */
        }
        .twitter-link {
    font-size: 1.1rem; /* Increase font size */
    color: #0a0a0a; /* Twitter blue color */
    text-decoration: none; /* Remove underline */
    transition: color 0.3s; /* Smooth color transition */
}

.twitter-link:hover {
    color: #0d8bdb; /* Darker blue on hover */
}

.twitter-link i {
    font-size: 1.3rem; /* Increase icon size */
    margin-right: 5px; 
    margin-top: 20px;/* Space between icon and text */
}

/* Updated styles for image and description */
.event-image {
    position: relative;
    width: 100%;
    height: 200px; /* Fixed height for consistent image containers */
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    cursor: zoom-in;
    overflow: hidden; /* Ensure content stays within bounds */
}

.expand-image-icon {
    position: absolute;
    bottom: 10px;
    right: 10px;
    background: rgba(0, 0, 0, 0.7);
    color: white;
    padding: 8px;
    border-radius: 50%;
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    opacity: 0;
    transition: opacity 0.3s;
}

.event-image:hover .expand-image-icon {
    opacity: 1;
}

.event-description {
    max-height: 150px; /* Adjust this value based on your needs */
    overflow-y: auto;
    padding-right: 10px;
    position: relative;
    scrollbar-width: thin;
    scrollbar-color: var(--nepal-red) #f0f0f0;
}

/* Scroll indicator */
.scroll-indicator {
    position: absolute;
    bottom: 0;
    right: 0;
    background: linear-gradient(transparent, white);
    padding: 5px 8px;
    border-radius: 4px;
    font-size: 12px;
    color: var(--nepal-red);
    opacity: 0.8;
    pointer-events: none;
}

/* Custom scrollbar styles */
.event-description::-webkit-scrollbar {
    width: 6px;
}

.event-description::-webkit-scrollbar-track {
    background: #f0f0f0;
    border-radius: 3px;
}

.event-description::-webkit-scrollbar-thumb {
    background: var(--nepal-red);
    border-radius: 3px;
}

/* Image modal styles */
.image-modal {
    display: none;
    position: fixed;
    z-index: 9999;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.9);
    cursor: pointer;
}

.modal-content {
    margin: auto;
    display: block;
    width: auto;
    height: auto;
    max-width: 90%;
    max-height: 90vh;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    object-fit: contain; /* Ensures image maintains aspect ratio */
}

.expand-image-icon {
    position: absolute;
    bottom: 10px;
    right: 10px;
    background: rgba(0, 0, 0, 0.7);
    color: white;
    padding: 8px;
    border-radius: 50%;
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    opacity: 0;
    transition: opacity 0.3s;
}

.event-image:hover .expand-image-icon {
    opacity: 1;
}

.expand-image-icon svg {
    width: 16px;
    height: 16px;
    color: white;
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .event-image {
        height: 180px; /* Slightly smaller height for mobile */
    }
}
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "Khojum",
        "url": "https://www.khojum.com",
        "logo": "/home/raman/Downloads/khojum-master/assets/logo/favicon.ico"
    
        
    }
    </script>
</head>
<body> <!--
    <div class="fixed-button-container">
        <a href="holi.html" class="animated-holi-button" id="holi-button">
            Holi Events!
        </a>
        <span id="days-left" class="days-left-message"></span> <!-- Countdown message outside the button -->
    </div> 

    <header>
        <div class="container">
            <div class="logo">
                <h1 id="khojum-logo"><span>‡§ñ‡•ã</span>‡§ú‡•Å‡§Æ</h1>
            </div>
            <div class="title-section">
                <h2>What are you doing this Week?</h2>
                <p>Discover the best events happening in Nepal this Week.</p>
                <span class="date-display" id="date-range">Date: March 13</span>
            </div>
        </div>
    </header>
    
    <div class="filter-bar" id="filterBar">
        <div class="container">
            <div class="filter-buttons">
                <button class="filter-button active" data-filter="all">All Events</button>
                <button class="filter-button" data-filter="today">Today</button>
                <button class="filter-button" data-filter="tomorrow">Tomorrow</button>
                <button class="filter-button" data-filter="Free">Free</button>
              
                <button class="filter-button" data-filter="music">Music</button><br>
  
                <button class="filter-button" data-filter="business" onclick()="openWhatsApp()">Discount code</button>
                <button class="filter-button" data-filter="sports">Sports</button>
            </div>
            <div class="sort-dropdown">
                <select id="sort-options">
                    <option value="time">Sort by Price</option>
                    <option value="popularity">Sort by Popularity</option>
                    <option value="price">Sort by Time</option>
                </select>
            </div>
        </div>
    </div>
   
    
    <main class="container">
        <div class="events-grid" id="events-container">
            <!-- Events will be dynamically populated here -->
        </div>
        
        <div class="loading" id="loading">
            <div class="loading-spinner"></div>
            <p>Loading more events...</p>
        </div>
    </main>
    
    <footer>
        <div class="container">
            <div class="logo-small">
                <span>‡§ñ‡•ã</span>‡§ú‡•Å‡§Æ
            </div>
  
           
            <p class="support-message">
                We value your feedback! <br>
                Help us grow or share your thoughts and suggestions at 
                <a href="mailto:ceo@khojum.com?subject=Feedback%20for%20Khojum" class="email-link">ceo@khojum.com</a>
            </p>
        </p> 
        <a href="https://x.com/ramanLogy" target="_blank" title="X" class="twitter-link">
            <i class="fab fa-twitter"></i> Twitter ( ùïè )
        </a>
        <p class="copyright">&copy; 2025 Khojum. All rights reserved.</p>
            <!-- Moved Archived Events Icon to Footer -->
            <div class="icon-box">
                <a href="expired.html" class="archived-events-icon" title="Archived Events">
                    <i class="fa fa-archive"></i> <!-- Font Awesome down arrow icon -->
                    <span>Archived Events</span>
                </a>
            </div>
            <!-- End of Archived Events Icon -->
        </div>
    </footer>

    <!-- Modal Structure -->
    <div id="event-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h2 id="modal-title"></h2>
            <p id="modal-summary"></p>
            <h3>Attendees:</h3>
            <ul id="modal-attendees"></ul>
            <h3>Special Highlights:</h3>
            <ul id="modal-highlights"></ul>
        </div>
    </div>

    <!-- Calendar Icon -->
    <div class="calendar-icon" id="calendarToggleBtn">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M19,4H17V3a1,1,0,0,0-2,0V4H9V3A1,1,0,0,0,7,3V4H5A3,3,0,0,0,2,7V19a3,3,0,0,0,3,3H19a3,3,0,0,0,3-3V7A3,3,0,0,0,19,4Zm1,15a1,1,0,0,1-1,1H5a1,1,0,0,1-1-1V10H20Zm0-11H4V7A1,1,0,0,1,5,6H7V7A1,1,0,0,0,9,7V6h6V7a1,1,0,0,0,2,0V6h2a1,1,0,0,1,1,1Z"/>
        </svg>
        <span class="calendar-label">Calendar</span>
    </div>
    

    <!-- Calendar Popup -->
    <div class="calendar-popup" id="calendarPopup">
        <div class="calendar-header">
            <div class="month-year" id="monthYear">March 2025</div>
            <div class="nav-buttons">
                <button class="nav-btn" id="prevMonth">
                    <svg width="16" height="16" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z" fill="currentColor"/>
                    </svg>
                </button>
                <button class="nav-btn" id="nextMonth">
                    <svg width="16" height="16" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z" fill="currentColor"/>
                    </svg>
                </button>
            </div>
        </div>
        
        <!-- Calendar Toggle -->
        <div class="calendar-toggle">
            <label class="switch">
                <input type="checkbox" id="calendarTypeToggle">
                <span class="slider round"></span>
            </label>
            <span class="toggle-label" id="calendarTypeLabel">ON (‡§®‡•á‡§™‡§æ‡§≤‡•Ä calendar)</span>
        </div>
        
        <div class="calendar-grid">
            <div class="weekdays" id="calendarWeekdays">
                <div>Su</div>
                <div>Mo</div>
                <div>Tu</div>
                <div>We</div>
                <div>Th</div>
                <div>Fr</div>
                <div>Sa</div>
            </div>
            <div class="days" id="calendarDays">
                <!-- Days will be generated by JavaScript -->
            </div>
        </div>
        
        <div class="events-panel" id="eventsPanel">
            <div class="event-date">No date selected</div>
            <div class="no-events">No events for this day</div>
        </div>
    </div>

    <!-- Image Modal -->
    <div id="imageModal" class="image-modal">
        <span class="close-modal">&times;</span>
        <img class="modal-content" id="modalImage">
        <div class="zoom-controls">
            <button id="zoomIn">+</button>
            <button id="zoomOut">-</button>
            <button id="resetZoom">Reset</button>
        </div>
    </div>

    <script>
        // Set the date range for "this week"
        document.addEventListener('DOMContentLoaded', function() {
            const now = new Date();
            const dayOfWeek = now.getDay();
            const startDate = new Date(now);
            startDate.setDate(now.getDate() - dayOfWeek); // Sunday
            
            const endDate = new Date(startDate);
            endDate.setDate(startDate.getDate() + 6); // Saturday
            
            const options = { month: 'long', day: 'numeric' };
            const dateRange = `${startDate.toLocaleDateString('en-US', options)} - ${endDate.toLocaleDateString('en-US', options)}, ${endDate.getFullYear()}`;
            
            document.getElementById('date-range').textContent = dateRange;
            
            // Load events
            loadEvents();
            
            // Set default sorting by time when the page loads
            sortEvents('time');
            
            // Set up filter buttons
            const filterButtons = document.querySelectorAll('.filter-button');
            filterButtons.forEach(button => {
                button.addEventListener('click', function() {
                    // Remove active class from all buttons
                    filterButtons.forEach(btn => btn.classList.remove('active'));
                    // Add active class to clicked button
                    this.classList.add('active');
                    // Filter events
                    const filter = this.getAttribute('data-filter');
                    filterEvents(filter);

                    // Check if the clicked button is the "Holi" button
                    if (filter === 'holi') {
                        createSprinkles(event);
                    }
                });
            });

            // Set up sort dropdown
            const sortDropdown = document.getElementById('sort-options');
            sortDropdown.addEventListener('change', function() {
                const sortCriteria = this.value;
                sortEvents(sortCriteria);
            });
        });
        
        // Sample business data
        const businesses = [
            
         {
    id: 1, 
    title: "Metal Monsters III",
    description: "After a long wait of five years, Metal Monsters III is finally back! This highly anticipated metal concert will take place on March 22 at Purple Haze Rock Bar in Kathmandu.\n\nThe event will feature three powerful bands: Antim Grahan, Binaash, and Strangle. This night is extra special as Antim Grahan will be launching their new album.\n\nPS. The Metal Monsters festival has been a great experience for Nepali metal fans. ü§ò",
    date: "March 22, 2025", // Date of the event
    time: "3:00 PM Onwards", // Time of the event
    location: "Purple Haze Rock Bar, Kathmandu, Nepal", // Venue
    price: "Rs. 500 - Rs 1000 (Imepay)", // Ticket information
    image: "assets/monsters.png", // Add the appropriate image path
    category: "Music", // Tags for filtering
    url: "https://www.instagram.com/nonextquestion/p/DHQ3inUSZGX/?api=slot%2Bbos%E3%80%90GB999.bet%E3%80%91.wtif&hl=ne", // URL can be added when available
    popularity: 8 // Adjust popularity as needed
},
   
           
  
  
   
             {
        id: 2, // New ID for the Jameson Patan Fest 2025 event
        title: "Jameson Patan Fest 2025",
        description: "Jameson Patan Fest 2025 is set to be one of the biggest events in Nepal this year! If you're searching for upcoming events in Nepal, concerts near me, or festivals in Kathmandu, this is where you need to be! On April 5, 2025, from 2:00 PM onwards, Chyasal Stadium will transform into a high-energy celebration of music, culture, and entertainment, featuring some of Nepal's most electrifying performers!\n\nOur first headline act is here‚ÄîJohn & The Locals! üî• Known for their unmatched energy and electrifying live performances, they're ready to take Jameson Patan Fest to the next level! But this is just the beginning‚Äîmore powerhouse artists are set to be revealed soon! Stay tuned as we build up to an epic music festival that will keep you on your feet all night long!",
        date: "April 5, 2025", // Date of the event
        time: "2:00 PM Onwards", // Time of the event
        location: "Chyasal Stadium, Lalitpur, Nepal", // Venue
        price: "Rs. 900 to Rs. 1500", // Price can be updated later
        image: "assets/jameson.png", // Add the appropriate image path
        category: "Music", // Tags for filtering
        url: "https://events.khalti.com/events/ET25HCWK4QJV", // Example URL for more information
        popularity: 10 // Adjust popularity as needed
    },
    {
        id: 3, // New ID for the 1974 AD - Live Kathmandu event
        title: "1974 AD - The last show in nepal",
        description: "1974 AD is a Nepali rock band formed in Kathmandu in the early 1990s. Known for experimenting with various genres, including Nepali folk, ragas, rock, funk, blues, and jazz, they are among Nepal's most successful recording artists. Many of their albums rank among the top ten bestsellers. This event could be their final performance in Nepal as they celebrate the 30th anniversary of their formation.",
        date: "April 5, 2025", // Date of the event
        time: "4:00 PM onwards", // Time of the event (to be announced)
        location: "Hyatt Regency Kathmandu, Kathmandu, Nepal", // Venue
        price: "Rs. 1000 to Rs. 2500", // Price range
        image: "assets/1974.png", // Add the appropriate image path
        category: "Music", // Tags for filtering
        url: "https://esewaevents.com/booking/1974-ad-live-in-kathmandu", // Example URL for more information
        popularity: 10 // Adjust popularity as needed
    },
             {
        id: 4, // New ID for the New Year Fest 2082 event
        
        title: "New Year Fest 2082",
        description: "New Year Fest 2082 is the ultimate way to kick off the Nepali New Year with high-energy live music, electrifying performances, and an unforgettable atmosphere! If you're searching for events in Nepal, upcoming events in Nepal, or concerts near you, this festival at Bhutandevi School Ground, Hetauda, is where you need to be!\n\nBrought to you by 8 Peaks Nepal, this festival features Albatross as the headliner, along with The Elements and more artists, ready to set the stage on fire! Get ready for a night of powerful beats, thrilling performances, and pure musical magic as we welcome Baisakh 1 with style, energy, and excitement! Don't miss out on the biggest New Year's Eve party in Nepal!",
        date: "April 14, 2025", // Date of the event
        time: "4:00 PM Onwards", // Time of the event
        location: "Bhutandevi Higher Secondary School, Hetauda, Nepal", // Venue
        price: "Early bird: RS. 500", // Price can be updated later
        image: "assets/elements.png", // Add the appropriate image path
        category: "Music", // Tags for filtering
        url: "https://events.khalti.com/events/ET25A9N43LYQ", // Example URL for more information
        popularity: 9 // Adjust popularity as needed
    },


        ];
        
        // Debugging: Log the businesses array before and after adding the new event
        console.log("Before adding new event:", businesses);
        // Add the new event here if not already included
        console.log("After adding new event:", businesses);
        
        function loadEvents() {
            const container = document.getElementById('events-container');
            container.innerHTML = ''; // Clear previous content

            const fragment = document.createDocumentFragment();
            
            businesses.forEach(event => {
                const eventCard = createEventCard(event);
                fragment.appendChild(eventCard);
            });

            container.appendChild(fragment); // Append all elements at once
        }

function openWhatsApp() {
    const phoneNumber = "9779861828821"; // Replace with your WhatsApp number in international format without '+'
    const message = "Message to get discount on tickets.!!"; // Customize your message
    const url = `https://api.whatsapp.com/send?phone=${phoneNumber}&text=${encodeURIComponent(message)}`;
    window.open(url, "_blank");
}
        function createEventCard(event) {
            const card = document.createElement('div');
            card.className = 'event-card';
            const categories = Array.isArray(event.category) ? event.category.join(',') : event.category;
            card.setAttribute('data-category', categories);
            
            const imageUrl = event.image || "assets/football-finals.png"; // Example image
            
            card.innerHTML = `
                <div class="event-image" style="background-image: url('${imageUrl}')">
                    <div class="event-category">${categories}</div>
                </div>
                <div class="event-content">
                    <h3 class="event-title">${event.title}</h3>
                    <div class="event-meta">
                        <div class="event-date">
                            <i class="far fa-calendar-alt"></i>
                            <span>${event.date}</span>
                        </div>
                        <div class="event-time">
                            <i class="far fa-clock"></i>
                            <span>${event.time}</span>
                        </div>
                    </div>
                    <div class="event-meta">
                        <div class="event-location">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>${event.location}</span>
                        </div>
                    </div>
                    <p class="event-description">${event.description}</p>
                    <div class="event-footer">
                        <div class="event-price-tag${event.price === 'Free' ? ' free' : ''}">
                            ${event.price}
                        </div>
                        <a href="${event.url}" class="event-button" target="_blank">
                            View Post <i class="fas fa-external-link-alt" aria-hidden="true"></i>
                            <span class="sr-only">(opens in a new tab)</span>
                        </a>
                    </div>
                    <div class="countdown-container">
                        <div class="event-time-counter" id="countdown-${event.id}"></div>
                    </div>
                </div>
            `;

            // Add click event to open modal
            card.addEventListener('click', () => {
                openModal(event);
            });

            return card;
        }
        
    
        
        function filterEvents(category) {
            const allEvents = document.querySelectorAll('.event-card');
            
            allEvents.forEach(event => {
                const eventCategories = event.getAttribute('data-category').split(',');
                const priceElement = event.querySelector('.event-price-tag');
                const isFreePrice = priceElement && priceElement.textContent.trim().includes('Free');
                
                if (category === 'all') {
                    event.style.display = 'block';
                } else if (category === 'Free') {
                    // Show events with "Free" price or "Free" category
                    if (isFreePrice || eventCategories.includes('Free')) {
                        event.style.display = 'block';
                    } else {
                        event.style.display = 'none';
                    }
                } else {
                    // Check if the event's categories include the selected category
                    if (eventCategories.some(cat => cat.trim().toLowerCase() === category.trim().toLowerCase())) {
                        event.style.display = 'block';
                    } else {
                        event.style.display = 'none';
                    }
                }
                
                // Debugging log
                console.log(`Event: ${event.querySelector('.event-title').textContent}, Category: ${eventCategories}`);
            });
        }

        function sortEvents(criteria) {
            const container = document.getElementById('events-container');
            const eventsArray = Array.from(container.children);

            eventsArray.sort((a, b) => {
                const eventA = businesses.find(event => event.title === a.querySelector('.event-title').textContent);
                const eventB = businesses.find(event => event.title === b.querySelector('.event-title').textContent);

                switch (criteria) {
                    case 'time':
                        const timeA = new Date(eventA.date + ' ' + eventA.time);
                        const timeB = new Date(eventB.date + ' ' + eventB.time);
                        return timeA - timeB; // Sort by time ascending
                    case 'popularity':
                        return eventB.popularity - eventA.popularity; // Sort by popularity descending
                    case 'price':
                        const priceA = parseFloat(eventA.price.replace(/[^0-9.-]+/g, "")) || 0;
                        const priceB = parseFloat(eventB.price.replace(/[^0-9.-]+/g, "")) || 0;
                        return priceA - priceB;
                    default:
                        return 0;
                }
            });

            // Clear and re-append sorted events
            container.innerHTML = '';
            eventsArray.forEach(event => container.appendChild(event));
        }

        function openModal(event) {
            const modal = document.getElementById('event-modal');
            const modalTitle = document.getElementById('modal-title');
            const modalSummary = document.getElementById('modal-summary');
            const modalAttendees = document.getElementById('modal-attendees');
            const modalHighlights = document.getElementById('modal-highlights');

            // Populate modal with event details
            modalTitle.textContent = event.title;
            modalSummary.textContent = event.description;

            // Clear previous attendees and highlights
            modalAttendees.innerHTML = '';
            modalHighlights.innerHTML = '';

            // Add attendees and highlights if available
            if (event.attendees) {
                event.attendees.forEach(attendee => {
                    const li = document.createElement('li');
                    li.textContent = attendee;
                    modalAttendees.appendChild(li);
                });
            }

            if (event.highlights) {
                event.highlights.forEach(highlight => {
                    const li = document.createElement('li');
                    li.textContent = highlight;
                    modalHighlights.appendChild(li);
                });
            }

            // Show the modal
            modal.style.display = 'block';

            // Close modal when the close button is clicked
            const closeButton = document.querySelector('.close-button');
            closeButton.onclick = function() {
                modal.style.display = 'none';
            }

            // Close modal when clicking outside of the modal content
            window.onclick = function(event) {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            }
        }

        function createSprinkles(event) {
            const sprinkleContainer = document.createElement("div");
            sprinkleContainer.classList.add("sprinkle-container");
            document.body.appendChild(sprinkleContainer);

            const numSprinkles = 20; // Number of sprinkles to generate
            for (let i = 0; i < numSprinkles; i++) {
                const sprinkle = document.createElement("div");
                sprinkle.classList.add("sprinkle");
                sprinkle.style.backgroundColor = getRandomColor();

                const x = event.clientX;
                const y = event.clientY;
                sprinkle.style.left = `${x}px`;
                sprinkle.style.top = `${y}px`;

                const angle = Math.random() * 2 * Math.PI;
                const distance = Math.random() * 100;
                const finalX = x + Math.cos(angle) * distance;
                const finalY = y + Math.sin(angle) * distance;

                document.body.appendChild(sprinkle);

                animateSprinkle(sprinkle, finalX, finalY);
            }
        }

        document.addEventListener("DOMContentLoaded", function() {
            const lazyImages = document.querySelectorAll("img.lazy-load");
            
            const observer = new IntersectionObserver(entries => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const img = entry.target;
                        img.src = img.dataset.src;
                        img.classList.remove("lazy-load");
                        observer.unobserve(img);
                    }
                });
            });

            lazyImages.forEach(img => observer.observe(img));
        });

        function createEventTimeCounter() {
            // Get all event cards
            const eventCards = document.querySelectorAll('.event-card');

            eventCards.forEach(card => {
                // Find the event in the businesses array
                const eventTitle = card.querySelector('.event-title').textContent;
                const event = businesses.find(e => e.title === eventTitle);

                if (event) {
                    // Create or find the time counter element
                    let timeCounterEl = card.querySelector('.event-time-counter');
                    if (!timeCounterEl) {
                        timeCounterEl = document.createElement('div');
                        timeCounterEl.classList.add('event-time-counter');
                        card.querySelector('.event-footer').insertBefore(timeCounterEl, card.querySelector('.event-button'));
                    }

                    // Parse the event date and time
                    const eventDateTime = parseEventDateTime(event.date, event.time);
                    
                    // Calculate time difference
                    const now = new Date();
                    const timeDiff = eventDateTime - now;

                    // Check if the event spans multiple days
                    const eventEndDateTime = new Date(eventDateTime);
                    eventEndDateTime.setDate(eventEndDateTime.getDate() + 1); // Assuming the event lasts for one day

                    // Style and text for different event states
                    if (timeDiff > 0) {
                        // Event is in the future
                        const days = Math.floor(timeDiff / (1000 * 60 * 60 * 24));
                        const hours = Math.floor((timeDiff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                        
                        timeCounterEl.textContent = `Starts in ${days}d ${hours}h`;
                        timeCounterEl.style.display = 'inline-block';
                        timeCounterEl.style.padding = '10px 15px';
                        timeCounterEl.style.border = '1px solid var(--nepal-red)';
                        timeCounterEl.style.borderRadius = '5px';
                        timeCounterEl.style.backgroundColor = 'white';
                        timeCounterEl.style.color = 'var(--nepal-red)';
                        timeCounterEl.style.fontWeight = 'bold';
                        timeCounterEl.style.textAlign = 'center';
                        timeCounterEl.style.cursor = 'pointer';
                        timeCounterEl.classList.add('upcoming');
                        timeCounterEl.classList.remove('happening', 'expired');
                    } else if (now >= eventDateTime && now < eventEndDateTime) { // Check if the event is happening now
                        // Event is happening now
                        timeCounterEl.textContent = 'Happening Now!';
                        timeCounterEl.style.display = 'inline-block';
                        timeCounterEl.style.padding = '10px 15px';
                        timeCounterEl.style.border = '1px solid var(--nepal-red)';
                        timeCounterEl.style.borderRadius = '5px';
                        timeCounterEl.style.backgroundColor = 'white';
                        timeCounterEl.style.color = 'var(--nepal-red)';
                        timeCounterEl.style.fontWeight = 'bold';
                        timeCounterEl.style.textAlign = 'center';
                        timeCounterEl.style.cursor = 'pointer';
                        timeCounterEl.classList.add('happening');
                        timeCounterEl.classList.remove('upcoming', 'expired');
                    } else {
                        // Event has passed
                        timeCounterEl.textContent = 'Expired';
                        timeCounterEl.style.display = 'inline-block';
                        timeCounterEl.style.padding = '10px 15px';
                        timeCounterEl.style.border = '1px solid var(--nepal-red)';
                        timeCounterEl.style.borderRadius = '5px';
                        timeCounterEl.style.backgroundColor = 'white';
                        timeCounterEl.style.color = 'var(--nepal-red)';
                        timeCounterEl.style.fontWeight = 'bold';
                        timeCounterEl.style.textAlign = 'center';
                        timeCounterEl.style.cursor = 'pointer';
                        timeCounterEl.classList.add('expired');
                        timeCounterEl.classList.remove('upcoming', 'happening');
                    }
                }
            });
        }

        function parseEventDateTime(dateString, timeString) {
            // Clean and parse the time string
            const timeParts = timeString.toLowerCase().replace(/\s*(am|pm|onwards)/g, '').trim();
            let [hours, minutes] = timeParts.split(':').map(Number);
            
            // Adjust for 12-hour format if needed
            if (timeString.toLowerCase().includes('pm') && hours !== 12) {
                hours += 12;
            }
            if (timeString.toLowerCase().includes('am') && hours === 12) {
                hours = 0;
            }

            // Parse the date
            const dateParts = dateString.split(/\s*-\s/); // Handle date ranges
            const parsedDate = new Date(dateParts[0]);

            // Set time
            parsedDate.setHours(hours || 0, minutes || 0, 0, 0);

            return parsedDate;
        }

        // Call the function when the page loads and update periodically
        document.addEventListener('DOMContentLoaded', createEventTimeCounter);
        setInterval(createEventTimeCounter, 60000); // Update every minute

        function updateCountdown() {
            const targetDate = new Date('March 13, 2025');
            const now = new Date();
            const timeDiff = targetDate - now;

            // Calculate days left
            const daysLeft = Math.ceil(timeDiff / (1000 * 60 * 60 * 24));

            // Update the animated button with days left
            const holiButton = document.getElementById('holi-button');
            const daysLeftElement = document.getElementById('days-left');
            if (daysLeft > 0) {
                holiButton.textContent = 'Search Holi Events';
                daysLeftElement.textContent = `(${daysLeft} days left)`; // Update countdown message
            } else {
                holiButton.textContent = 'Celebrate Holi! (Event has passed)';
                daysLeftElement.textContent = ''; // Clear countdown message
            }
        }

        // Update countdown on page load
        document.addEventListener('DOMContentLoaded', function() {
            updateCountdown(); // Call the function to set the initial value
        });

        document.addEventListener('DOMContentLoaded', function() {
    const calendarIcon = document.getElementById('calendarToggleBtn');
    const calendarPopup = document.getElementById('calendarPopup');
    const monthYearElement = document.getElementById('monthYear');
    const calendarDaysElement = document.getElementById('calendarDays');
    const calendarWeekdays = document.getElementById('calendarWeekdays');
    const eventsPanel = document.getElementById('eventsPanel');
    const prevMonthBtn = document.getElementById('prevMonth');
    const nextMonthBtn = document.getElementById('nextMonth');
    const calendarToggle = document.getElementById('calendarTypeToggle');
    const calendarTypeLabel = document.getElementById('calendarTypeLabel');
    const addEventBtn = document.getElementById('addEventBtn');
    const eventForm = document.getElementById('eventForm');
    const shareButton = document.getElementById('shareCalendarBtn');
    
    // Sample events data - replace with your own
    let events = {
        "2025-03-13": [
            { id: 1, description: "Kuma sagar and khowpa at malla hotel", isPublic: true },
            { id: 2, description: "HOli daurbarmarg", isPublic: true }
        ],
        "2025-03-15": [
            { id: 3, description: "Product launch", isPublic: false },
            { id: 4, description: "Marketing review", isPublic: true }
        ],
        "2025-03-20": [
            { id: 5, description: "Quarterly review", isPublic: false }
        ],
        "2025-03-25": [
            { id: 6, description: "Training session", isPublic: true },
            { id: 7, description: "Budget planning", isPublic: false }
        ]
    };
    
    // Holiday data
    const holidays = {
        // English calendar holidays (YYYY-MM-DD)
        "english": {
            "2025-03-08": "International Women's Day",
            "2025-03-17": "St. Patrick's Day",
            "2025-03-20": "March Equinox",
            "2025-03-29": "Holi",
            "2025-04-13": "Nepali New Year (Baisakh 1)"
        },
        // Nepali calendar holidays (YYYY-MM-DD)
        "nepali": {
            "2081-12-25": "Holi",
            "2082-01-01": "Nepali New Year",
            "2081-12-13": "International Women's Day",
            "2081-12-30": "Rama Navami"
        }
    };
    
    let currentDate = new Date();
    let currentMonth = currentDate.getMonth();
    let currentYear = currentDate.getFullYear();
    let selectedDate = null;
    let isNepaliCalendar = false;
    
    // Function to close calendar
    function closeCalendar() {
        if (calendarPopup) {
            calendarPopup.classList.remove('active');
        }
    }

    // Toggle calendar when icon is clicked
    calendarIcon.addEventListener('click', function(e) {
        e.preventDefault();
        e.stopPropagation(); // Stop the click from bubbling up
        calendarPopup.classList.toggle('active');
        if (calendarPopup.classList.contains('active')) {
            generateCalendar(currentMonth, currentYear);
        }
    });

    // Close calendar when clicking anywhere on the document
    document.addEventListener('click', function(e) {
        // Check if click is outside calendar popup and icon
        if (!calendarPopup.contains(e.target) && !calendarIcon.contains(e.target)) {
            closeCalendar();
        }
    });

    // Prevent calendar from closing when clicking inside it
    calendarPopup.addEventListener('click', function(e) {
        e.stopPropagation(); // Stop the click from reaching the document
    });

    // Close calendar with ESC key
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
            closeCalendar();
        }
    });
    
    // Toggle between English and Nepali calendars
    calendarToggle.addEventListener('change', function() {
        isNepaliCalendar = this.checked;
        calendarTypeLabel.textContent = isNepaliCalendar ? 'OFF (English Calendar)' : 'ON (Nepali Calendar)';
        
        // Smooth transition effect
        calendarDaysElement.classList.add('calendar-transition');
        calendarWeekdays.classList.add('calendar-transition');
        
        setTimeout(() => {
            // Update weekday names
            updateWeekdayLabels();
            
            // Regenerate calendar
            generateCalendar(currentMonth, currentYear);
            
            // Remove transition class after animation completes
            setTimeout(() => {
                calendarDaysElement.classList.remove('calendar-transition');
                calendarWeekdays.classList.remove('calendar-transition');
            }, 300);
        }, 150);
    });
    
    // Navigate to previous month
    prevMonthBtn.addEventListener('click', function() {
        currentMonth--;
        if (currentMonth < 0) {
            currentMonth = 11; // Wrap to December
            currentYear--; // Decrease year
        }
        generateCalendar(currentMonth, currentYear); // Regenerate calendar
        updateMonthYearDisplay(); // Update displayed month and year
    });
    
    // Navigate to next month
    nextMonthBtn.addEventListener('click', function() {
        currentMonth++;
        if (currentMonth > 11) {
            currentMonth = 0; // Wrap to January
            currentYear++; // Increase year
        }
        generateCalendar(currentMonth, currentYear); // Regenerate calendar
        updateMonthYearDisplay(); // Update displayed month and year
    });
    
    // Add event button click
    addEventBtn.addEventListener('click', function() {
        if (!selectedDate) {
            selectedDate = new Date();
        }
        
        const dateStr = formatDateDisplay(selectedDate, false);
        document.getElementById('eventDate').value = formatDateKey(selectedDate);
        document.getElementById('selectedDateDisplay').textContent = dateStr;
        document.getElementById('eventPublic').checked = true;
        document.getElementById('eventDescription').value = '';
        
        eventForm.classList.add('active');
    });
    
    // Share calendar button
    shareButton.addEventListener('click', function() {
        const publicEvents = {};
        
        // Filter for public events only
        for (const dateKey in events) {
            const publicDateEvents = events[dateKey].filter(event => event.isPublic);
            if (publicDateEvents.length > 0) {
                publicEvents[dateKey] = publicDateEvents;
            }
        }
        
        // Generate shareable link
        const shareableData = btoa(JSON.stringify(publicEvents));
        const shareableLink = `${window.location.origin}${window.location.pathname}?shared=${shareableData}`;
        
        // Display sharing modal with link
        alert(`Share this link with others:\n${shareableLink}`);
        
        // In a real implementation, you would show a proper modal with copy functionality
    });
    
    // Handle event form submission
    document.getElementById('eventSubmitBtn').addEventListener('click', function(e) {
        e.preventDefault();
        
        const dateKey = document.getElementById('eventDate').value;
        const description = document.getElementById('eventDescription').value.trim();
        const isPublic = document.getElementById('eventPublic').checked;
        
        if (!description) {
            alert('Please enter an event description');
            return;
        }
        
        // Create event object
        const newEvent = {
            id: Date.now(), // Simple unique ID
            description: description,
            isPublic: isPublic
        };
        
        // Add to events object
        if (!events[dateKey]) {
            events[dateKey] = [];
        }
        events[dateKey].push(newEvent);
        
        // Reset form
        eventForm.classList.remove('active');
        document.getElementById('eventDescription').value = '';
        
        // Refresh calendar
        generateCalendar(currentMonth, currentYear);
        
        // If selected date has the new event, update events panel
        if (selectedDate && formatDateKey(selectedDate) === dateKey) {
            displayEvents(selectedDate);
        }
    });
    
    // Cancel event form
    document.getElementById('eventCancelBtn').addEventListener('click', function(e) {
        e.preventDefault();
        eventForm.classList.remove('active');
    });
    
    // Update weekday labels based on calendar type
    function updateWeekdayLabels() {
        const englishWeekdays = ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'];
        const nepaliWeekdays = ['‡§Ü', '‡§∏‡•ã', '‡§Æ‡§Ç', '‡§¨‡•Å', '‡§¨‡§ø', '‡§∂‡•Å', '‡§∂'];
        
        const weekdays = isNepaliCalendar ? nepaliWeekdays : englishWeekdays;
        
        calendarWeekdays.innerHTML = '';
        weekdays.forEach(day => {
            const dayElement = document.createElement('div');
            dayElement.textContent = day;
            calendarWeekdays.appendChild(dayElement);
        });
    }
    
    // Format date for events lookup
    function formatDateKey(date) {
        return date.getFullYear() + "-" + String(date.getMonth() + 1).padStart(2, '0') + "-" + String(date.getDate()).padStart(2, '0');
    }
    
    // Format date for display
    function formatDateDisplay(date, includeWeekday = true) {
        const options = includeWeekday
            ? { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' }
            : { year: 'numeric', month: 'long', day: 'numeric' };
        
        return date.toLocaleDateString('en-US', options);
    }
    
    // Check if date has events
    function hasEvents(date) {
        const dateKey = formatDateKey(date);
        return events[dateKey] !== undefined && events[dateKey].length > 0;
    }
    
    // Check if date is a holiday
    function isHoliday(date) {
        if (isNepaliCalendar) {
            const nepaliDate = convertToNepaliDate(date.getFullYear(), date.getMonth(), date.getDate());
            const nepaliDateKey = `${nepaliDate.year}-${String(nepaliDate.month + 1).padStart(2, '0')}-${String(nepaliDate.day).padStart(2, '0')}`;
            return holidays.nepali[nepaliDateKey];
        } else {
            const dateKey = formatDateKey(date);
            return holidays.english[dateKey];
        }
    }
    
    // Get holiday name
    function getHolidayName(date) {
        if (isNepaliCalendar) {
            const nepaliDate = convertToNepaliDate(date.getFullYear(), date.getMonth(), date.getDate());
            const nepaliDateKey = `${nepaliDate.year}-${String(nepaliDate.month + 1).padStart(2, '0')}-${String(nepaliDate.day).padStart(2, '0')}`;
            return holidays.nepali[nepaliDateKey];
        } else {
            const dateKey = formatDateKey(date);
            return holidays.english[dateKey];
        }
    }
    
    // Convert English date to Nepali date
    function convertToNepaliDate(year, month, day) {
        // This is a more accurate conversion than the original code
        // Using a reference date approach
        
        // Reference: Jan 1, 2025 is Poush 17, 2081 in Nepali calendar
        const referenceEnglishDate = new Date(2025, 0, 1); // Jan 1, 2025
        const referenceNepaliYear = 2081;
        const referenceNepaliMonth = 8; // Poush (0-indexed)
        const referenceNepaliDay = 17;
        
        // Nepali month names and days in month
        const nepaliMonths = [
            '‡§¨‡•à‡§∂‡§æ‡§ñ', '‡§ú‡•á‡§†', '‡§Ö‡§∏‡§æ‡§∞', '‡§∂‡•ç‡§∞‡§æ‡§µ‡§£', '‡§≠‡§¶‡•å', '‡§Ö‡§∏‡•ã‡§ú', 
            '‡§ï‡§æ‡§∞‡•ç‡§§‡§ø‡§ï', '‡§Æ‡§Ç‡§∏‡§ø‡§∞', '‡§™‡•Å‡§∑', '‡§Æ‡§æ‡§ò', '‡§´‡§æ‡§ó‡•Å‡§®', '‡§ö‡•à‡§§'
        ];
        
        const nepaliDaysInMonth = {
            2081: [31, 31, 32, 31, 31, 31, 30, 29, 30, 29, 30, 30], // Days in each month for Nepali year 2081
            2082: [31, 31, 32, 31, 31, 31, 30, 29, 30, 29, 30, 30]  // Days in each month for Nepali year 2082
        };
        
        // Calculate days difference
        const targetDate = new Date(year, month, day);
        const millisecondsPerDay = 24 * 60 * 60 * 1000;
        const daysDifference = Math.round((targetDate - referenceEnglishDate) / millisecondsPerDay);
        
        // Start with reference Nepali date and add the difference
        let nepaliYear = referenceNepaliYear;
        let nepaliMonth = referenceNepaliMonth;
        let nepaliDay = referenceNepaliDay;
        
        let remainingDays = daysDifference;
        
        if (remainingDays >= 0) {
            // Moving forward in time
            while (remainingDays > 0) {
                const daysInCurrentMonth = nepaliDaysInMonth[nepaliYear][nepaliMonth];
                const daysRemainingInMonth = daysInCurrentMonth - nepaliDay;
                
                if (remainingDays <= daysRemainingInMonth) {
                    nepaliDay += remainingDays;
                    remainingDays = 0;
                } else {
                    remainingDays -= (daysRemainingInMonth + 1);
                    nepaliMonth++;
                    nepaliDay = 1;
                    
                    if (nepaliMonth > 11) {
                        nepaliMonth = 0;
                        nepaliYear++;
                    }
                }
            }
        } else {
            // Moving backward in time
            remainingDays = Math.abs(remainingDays);
            while (remainingDays > 0) {
                if (nepaliDay > 1) {
                    nepaliDay--;
                    remainingDays--;
                } else {
                    nepaliMonth--;
                    if (nepaliMonth < 0) {
                        nepaliMonth = 11;
                        nepaliYear--;
                    }
                    nepaliDay = nepaliDaysInMonth[nepaliYear][nepaliMonth];
                    remainingDays--;
                }
            }
        }
        
        // Convert Nepali digits if needed
        const nepaliDigits = ['‡•¶', '‡•ß', '‡•®', '‡•©', '‡•™', '‡•´', '‡•¨', '‡•≠', '‡•Æ', '‡•Ø'];
        
        return {
            year: nepaliYear,
            month: nepaliMonth,
            day: nepaliDay,
            monthName: nepaliMonths[nepaliMonth],
            // Convert regular digits to Nepali digits
            dayNepali: nepaliDay.toString().split('').map(d => nepaliDigits[parseInt(d)]).join(''),
            yearNepali: nepaliYear.toString().split('').map(d => nepaliDigits[parseInt(d)]).join('')
        };
    }
    
    // Convert Nepali date to English date
    function convertToEnglishDate(nepaliYear, nepaliMonth, nepaliDay) {
        // Reference: Poush 17, 2081 is Jan 1, 2025 in English calendar
        const referenceEnglishDate = new Date(2025, 0, 1); // Jan 1, 2025
        const referenceNepaliYear = 2081;
        const referenceNepaliMonth = 8; // Poush (0-indexed)
        const referenceNepaliDay = 17;
        
        const nepaliDaysInMonth = {
            2081: [31, 31, 32, 31, 31, 31, 30, 29, 30, 29, 30, 30], // Days in each month for Nepali year 2081
            2082: [31, 31, 32, 31, 31, 31, 30, 29, 30, 29, 30, 30]  // Days in each month for Nepali year 2082
        };
        
        // Calculate days difference from reference Nepali date
        let daysDifference = 0;
        
        // For different years
        for (let year = referenceNepaliYear; year < nepaliYear; year++) {
            for (let month = 0; month < 12; month++) {
                daysDifference += nepaliDaysInMonth[year][month];
            }
        }
        
        // For same year but different months
        for (let month = referenceNepaliMonth; month < nepaliMonth; month++) {
            daysDifference += nepaliDaysInMonth[nepaliYear][month];
        }
        
        // For same month but different days
        daysDifference += nepaliDay - referenceNepaliDay;
        
        // Calculate the resulting English date
        const resultEnglishDate = new Date(referenceEnglishDate);
        resultEnglishDate.setDate(resultEnglishDate.getDate() + daysDifference);
        
        return {
            year: resultEnglishDate.getFullYear(),
            month: resultEnglishDate.getMonth(),
            day: resultEnglishDate.getDate()
        };
    }
    
    // Display events for selected date
    function displayEvents(date) {
        const dateKey = formatDateKey(date);
        let formattedDate;
        let holidayInfo = '';
        
        if (isNepaliCalendar) {
            const nepaliDate = convertToNepaliDate(date.getFullYear(), date.getMonth(), date.getDate());
            formattedDate = `${nepaliDate.dayNepali} ${nepaliDate.monthName} ${nepaliDate.yearNepali}`;
            
            // Check for holiday
            const nepaliDateKey = `${nepaliDate.year}-${String(nepaliDate.month + 1).padStart(2, '0')}-${String(nepaliDate.day).padStart(2, '0')}`;
            if (holidays.nepali[nepaliDateKey]) {
                holidayInfo = `<div class="holiday-badge">${holidays.nepali[nepaliDateKey]}</div>`;
            }
            
            // Also show English date for reference
            const englishDateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const englishDate = date.toLocaleDateString('en-US', englishDateOptions);
            formattedDate += `<div class="english-date">(${englishDate})</div>`;
        } else {
            const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            formattedDate = date.toLocaleDateString('en-US', dateOptions);
            
            // Check for holiday
            if (holidays.english[dateKey]) {
                holidayInfo = `<div class="holiday-badge">${holidays.english[dateKey]}</div>`;
            }
            
            // Show Nepali date for reference
            const nepaliDate = convertToNepaliDate(date.getFullYear(), date.getMonth(), date.getDate());
            formattedDate += `<div class="nepali-date">${nepaliDate.dayNepali} ${nepaliDate.monthName} ${nepaliDate.yearNepali}</div>`;
        }
        
        let html = '<div class="event-date">' + formattedDate + '</div>' + holidayInfo;
        
        if (events[dateKey] && events[dateKey].length > 0) {
            html += '<ul class="event-list">';
            events[dateKey].forEach(function(event) {
                html += `
                    <li class="event-item" data-event-id="${event.id}">
                        <div class="event-content">
                            <span>${event.description}</span>
                            ${event.isPublic ? '<span class="public-badge">Public</span>' : '<span class="private-badge">Private</span>'}
                        </div>
                        <button class="delete-event" data-id="${event.id}">√ó</button>
                    </li>`;
            });
            html += '</ul>';
        } else {
            html += '<div class="no-events">No events for this day</div>';
        }
        
        eventsPanel.innerHTML = html;
        
        // Add event listeners for delete buttons
        document.querySelectorAll('.delete-event').forEach(button => {
            button.addEventListener('click', function(e) {
                e.stopPropagation();
                const eventId = parseInt(this.getAttribute('data-id'));
                
                // Filter out the event with matching ID
                events[dateKey] = events[dateKey].filter(event => event.id !== eventId);
                
                // Remove the date key if no events remain
                if (events[dateKey].length === 0) {
                    delete events[dateKey];
                }
                
                // Refresh the events panel
                displayEvents(selectedDate);
                
                // Refresh the calendar to update event indicators
                generateCalendar(currentMonth, currentYear);
            });
        });
    }
    
    // Generate calendar grid
    function generateCalendar(month, year) {
        // Clear previous days
        calendarDaysElement.innerHTML = '';
        
        // Update header month and year
        if (isNepaliCalendar) {
            const nepaliMonths = [
                '‡§¨‡•à‡§∂‡§æ‡§ñ', '‡§ú‡•á‡§†', '‡§Ö‡§∏‡§æ‡§∞', '‡§∂‡•ç‡§∞‡§æ‡§µ‡§£', '‡§≠‡§¶‡•å', '‡§Ö‡§∏‡•ã‡§ú', 
                '‡§ï‡§æ‡§∞‡•ç‡§§‡§ø‡§ï', '‡§Æ‡§Ç‡§∏‡§ø‡§∞', '‡§™‡•Å‡§∑', '‡§Æ‡§æ‡§ò', '‡§´‡§æ‡§ó‡•Å‡§®', '‡§ö‡•à‡§§'
            ];
            
            const nepaliDate = convertToNepaliDate(year, month, 1);
            const nepaliDigits = ['‡•¶', '‡•ß', '‡•®', '‡•©', '‡•™', '‡•´', '‡•¨', '‡•≠', '‡•Æ', '‡•Ø'];
            const nepaliYear = nepaliDate.year.toString().split('').map(d => nepaliDigits[parseInt(d)]).join('');
            
            monthYearElement.textContent = nepaliMonths[nepaliDate.month] + ' ' + nepaliYear;
        } else {
            const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
            monthYearElement.textContent = monthNames[month] + ' ' + year;
        }
        
        // Get first day of month and number of days
        const firstDay = new Date(year, month, 1).getDay();
        const daysInMonth = new Date(year, month + 1, 0).getDate();
        
        // Get last day of previous month
        const prevMonthDays = new Date(year, month, 0).getDate();
        
        // Previous month's days
        for (let i = 0; i < firstDay; i++) {
            const dayElement = document.createElement('div');
            dayElement.className = 'day inactive';
            
            const dayNum = prevMonthDays - (firstDay - i - 1);
            const prevDate = new Date(year, month - 1, dayNum);
            
            if (isNepaliCalendar) {
                const prevMonth = month - 1 < 0 ? 11 : month - 1;
                const prevYear = prevMonth === 11 ? year - 1 : year;
                const nepaliDate = convertToNepaliDate(prevYear, prevMonth, dayNum);
                dayElement.textContent = nepaliDate.dayNepali;
            } else {
                dayElement.textContent = dayNum;
            }
            
            calendarDaysElement.appendChild(dayElement);
        }
        
        // Current month's days
        const today = new Date();
        for (let i = 1; i <= daysInMonth; i++) {
            const dayElement = document.createElement('div');
            dayElement.className = 'day';
            
            // Create date object for this calendar day
            const calendarDate = new Date(year, month, i);
            
            // Display the date
            if (isNepaliCalendar) {
                const nepaliDate = convertToNepaliDate(year, month, i);
                dayElement.textContent = nepaliDate.dayNepali;
            } else {
                dayElement.textContent = i;
            }
            
            // Check if it's today
            if (i === today.getDate() && month === today.getMonth() && year === today.getFullYear()) {
                dayElement.classList.add('today');
            }
            
            // Check if it's the selected date
            if (selectedDate && i === selectedDate.getDate() && month === selectedDate.getMonth() && year === selectedDate.getFullYear()) {
                dayElement.classList.add('selected');
            }
            
            // Check if date has events
            if (hasEvents(calendarDate)) {
                dayElement.classList.add('event');
            }
            
            // Check if date is a holiday
            if (isHoliday(calendarDate)) {
                dayElement.classList.add('holiday');
                
                // Add tooltip for holiday name
                const holidayName = getHolidayName(calendarDate);
                dayElement.setAttribute('title', holidayName);
                
                // Add holiday indicator dot
                const holidayDot = document.createElement('span');
                holidayDot.className = 'holiday-dot';
                dayElement.appendChild(holidayDot);
            }
            
            // Handle click on day
            dayElement.addEventListener('click', function() {
                // Remove selected class from all days
                document.querySelectorAll('.day.selected').forEach(function(el) {
                    el.classList.remove('selected');
                });
                
                // Add selected class to clicked day
                dayElement.classList.add('selected');
                
                // Update selected date
                selectedDate = new Date(year, month, i);
                
                // Display events for this date
                displayEvents(selectedDate);
            });
            
            calendarDaysElement.appendChild(dayElement);
        }
        
        // Next month's days to fill remaining cells
        const totalCells = 42; // 6 rows √ó 7 days
        const remainingCells = totalCells - (firstDay + daysInMonth);
        
        for (let i = 0; i < remainingCells; i++) {
            const dayElement = document.createElement('div');
            dayElement.className = 'day inactive';
            
            const dayNum = i + 1;
            
            if (isNepaliCalendar) {
                const nextMonth = month + 1 > 11 ? 0 : month + 1;
                const nextYear = nextMonth === 0 ? year + 1 : year;
                const nepaliDate = convertToNepaliDate(nextYear, nextMonth, dayNum);
                dayElement.textContent = nepaliDate.dayNepali;
            } else {
                dayElement.textContent = dayNum;
            }
            
            calendarDaysElement.appendChild(dayElement);
        }
        
        // If no date is selected, select today (first time) or keep current selection
        if (!selectedDate) {
            selectedDate = new Date();
            displayEvents(selectedDate);
        }
    }
    
    // Check for shared calendar in URL
    function loadSharedCalendar() {
        const urlParams = new URLSearchParams(window.location.search);
        const sharedParam = urlParams.get('shared');
        
        if (sharedParam) {
            try {
                const sharedEvents = JSON.parse(atob(sharedParam));
                
                // Merge shared events with user's events (or replace entirely)
                // This implementation merges them, keeping user's private events
                for (const dateKey in sharedEvents) {
                    if (!events[dateKey]) {
                        events[dateKey] = [];
                    }
                    
                    // Add shared events with isShared flag
                    sharedEvents[dateKey].forEach(event => {
                        // Check if this shared event is already in the user's calendar
                        const isDuplicate = events[dateKey].some(e => 
                            e.description === event.description);
                        
                        if (!isDuplicate) {
                            events[dateKey].push({
                                ...event,
                                isShared: true
                            });
                        }
                    });
                }
                
                // Show notification
                alert('Shared calendar events have been loaded!');
                
                // Refresh calendar
                generateCalendar(currentMonth, currentYear);
            } catch (e) {
                console.error('Error loading shared calendar:', e);
            }
        }
    }
    
    // Initialize weekday labels
    updateWeekdayLabels();
    
    // Initialize calendar with current month
    generateCalendar(currentMonth, currentYear);
    
    // Load shared calendar if present in URL
    loadSharedCalendar();
});

document.getElementById('khojum-logo').addEventListener('click', function() {
    window.location.href = 'index.html'; // Navigate to the main page
});

document.addEventListener('DOMContentLoaded', function() {
    // Add expand icons to all event images
    document.querySelectorAll('.event-image').forEach(imageContainer => {
        // Create expand icon
        const expandIcon = document.createElement('div');
        expandIcon.className = 'expand-image-icon';
        expandIcon.innerHTML = `
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M15 3h6v6M9 21H3v-6M21 3l-7 7M3 21l7-7"/>
            </svg>`;
        imageContainer.appendChild(expandIcon);

        // Extract background image URL
        const computedStyle = window.getComputedStyle(imageContainer);
        const backgroundImage = computedStyle.backgroundImage;
        const imageUrl = backgroundImage.slice(4, -1).replace(/["']/g, "");

        // Store the original image URL as a data attribute
        imageContainer.setAttribute('data-image-url', imageUrl);

        // Add click event to the entire image container
        imageContainer.addEventListener('click', function(e) {
            const imgUrl = this.getAttribute('data-image-url');
            if (imgUrl) {
                const modal = document.getElementById('imageModal');
                const modalImg = document.getElementById('modalImage');
                modal.style.display = "block";
                modalImg.src = imgUrl;
            }
        });
    });

    // Image Modal functionality
    const modal = document.getElementById('imageModal');
    const modalImg = document.getElementById('modalImage');

    // Close modal when clicking anywhere
    modal.addEventListener('click', function(e) {
        if (e.target === modal) {
            this.style.display = "none";
        }
    });

    // Close modal with Escape key
    window.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && modal.style.display === 'block') {
            modal.style.display = "none";
        }
    });

    // Handle modal image loading error
    modalImg.addEventListener('error', function() {
        console.error('Failed to load image');
        modal.style.display = "none";
        // Optionally show an error message to the user
        alert('Failed to load image');
    });
});

document.addEventListener('DOMContentLoaded', function() {
    // Function to check if a date is today
    function isToday(date) {
        const today = new Date();
        return date.getDate() === today.getDate() &&
               date.getMonth() === today.getMonth() &&
               date.getFullYear() === today.getFullYear();
    }

    // Function to check if a date is tomorrow
    function isTomorrow(date) {
        const tomorrow = new Date();
        tomorrow.setDate(tomorrow.getDate() + 1);
        return date.getDate() === tomorrow.getDate() &&
               date.getMonth() === tomorrow.getMonth() &&
               date.getFullYear() === tomorrow.getFullYear();
    }

    // Filter button click handlers
    document.querySelectorAll('.filter-button').forEach(button => {
        button.addEventListener('click', function() {
            const filter = this.getAttribute('data-filter');
            
            // Remove active class from all buttons
            document.querySelectorAll('.filter-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Add active class to clicked button
            this.classList.add('active');

            // Filter events
            const eventCards = document.querySelectorAll('.event-card');
            let foundEvents = false;

            eventCards.forEach(card => {
                const dateText = card.querySelector('.event-date').textContent;
                const eventDate = new Date(dateText);

                switch(filter) {
                    case 'today':
                        card.style.display = isToday(eventDate) ? 'block' : 'none';
                        if (isToday(eventDate)) foundEvents = true;
                        break;
                    case 'tomorrow':
                        card.style.display = isTomorrow(eventDate) ? 'block' : 'none';
                        if (isTomorrow(eventDate)) foundEvents = true;
                        break;
                    case 'all':
                        card.style.display = 'block';
                        foundEvents = true;
                        break;
                    default:
                        // Handle category filtering
                        const category = card.querySelector('.event-category').textContent.toLowerCase();
                        card.style.display = (filter === 'all' || category === filter.toLowerCase()) ? 'block' : 'none';
                        if (card.style.display === 'block') foundEvents = true;
                }
            });

            // Show/hide no events message
            const messageContainer = document.getElementById('no-events-message') || 
                                  createNoEventsMessage();
            messageContainer.style.display = foundEvents ? 'none' : 'block';
            messageContainer.textContent = foundEvents ? '' : 
                                        `No events ${filter === 'today' ? 'today' : 
                                          filter === 'tomorrow' ? 'tomorrow' : 
                                          'in this category'}`;
        });
    });

    function createNoEventsMessage() {
        const messageContainer = document.createElement('div');
        messageContainer.id = 'no-events-message';
        messageContainer.style.cssText = `
            width: 100%;
            padding: 20px;
            text-align: center;
            color: #666;
            background: #f8f8f8;
            border-radius: 8px;
            margin: 20px 0;
            grid-column: 1 / -1;
        `;
        document.querySelector('.events-grid').appendChild(messageContainer);
        return messageContainer;
    }

    // Trigger "All" filter by default instead of "Today"
    document.querySelector('.filter-button[data-filter="all"]').click();
});

document.addEventListener('DOMContentLoaded', function() {
    // Function to generate structured data for events
    function generateEventStructuredData() {
        const eventCards = document.querySelectorAll('.event-card');
        const structuredData = {
            "@context": "https://schema.org",
            "@type": "ItemList",
            "itemListElement": []
        };

        eventCards.forEach((card, index) => {
            const eventData = {
                "@type": "Event",
                "name": card.querySelector('.event-title')?.textContent,
                "description": card.querySelector('.event-description')?.textContent,
                "startDate": card.querySelector('.event-date')?.getAttribute('data-date'),
                "location": {
                    "@type": "Place",
                    "name": card.querySelector('.event-venue')?.textContent,
                    "address": {
                        "@type": "PostalAddress",
                        "addressLocality": "Kathmandu",
                        "addressRegion": "Bagmati",
                        "addressCountry": "NP"
                    }
                },
                "image": card.querySelector('.event-image')?.getAttribute('data-image-url'),
                "offers": {
                    "@type": "Offer",
                    "price": card.querySelector('.event-price')?.textContent.replace(/[^0-9]/g, ''),
                    "priceCurrency": "NPR"
                }
            };
            structuredData.itemListElement.push(eventData);
        });

        // Update or create structured data script tag
        let scriptTag = document.querySelector('script[data-type="event-structured-data"]');
        if (!scriptTag) {
            scriptTag = document.createElement('script');
            scriptTag.setAttribute('type', 'application/ld+json');
            scriptTag.setAttribute('data-type', 'event-structured-data');
            document.head.appendChild(scriptTag);
        }
        scriptTag.textContent = JSON.stringify(structuredData);
    }

    // Generate structured data when page loads
    generateEventStructuredData();

    // Update structured data when events are filtered
    document.querySelectorAll('.filter-button').forEach(button => {
        button.addEventListener('click', () => {
            setTimeout(generateEventStructuredData, 100);
        });
    });
});
    </script>
</body>
</html>
