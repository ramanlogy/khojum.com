<!DOCTYPE html>
<html lang="en">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-7LWHSBNXT5"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-7LWHSBNXT5');
    </script>
    <!-- Primary Meta Tags -->
    <title>Discover Events in Nepal | Khojum.com</title>
    <meta name="title" content="Discover Events in Nepal | Khojum.com">
    <meta name="description" content="Nepal's top event discovery platform. Find concerts, festivals, art exhibitions, and workshops in Kathmandu and beyond. Your guide to what's happening.">

    <!-- Keywords -->
    <meta name="keywords" content="events in kathmandu, nepal events, concerts, festivals, art exhibitions, workshops, entertainment, today's events, upcoming events, khojum">

    <!-- SEO & Indexing -->
    <meta name="robots" content="index, follow, max-image-preview:large">
    <link rel="canonical" href="https://khojum.com">

    <!-- Mobile Optimization -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#ffffff">

    <!-- Favicons -->
    <link rel="icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png">

    <!-- Open Graph & Twitter Cards (dynamically updated) -->
    <meta property="og:title" content="Discover Events in Nepal | Khojum.com">
    <meta property="og:description" content="Nepal's top event discovery platform for concerts, festivals, and more.">
    <meta property="og:image" content="https://khojum.com/assets/logo/og-image.png">
    <meta property="og:url" content="https://khojum.com">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Discover Events in Nepal | Khojum.com">
    <meta name="twitter:description" content="Nepal's top event discovery platform for concerts, festivals, and more.">
    <meta name="twitter:image" content="https://khojum.com/assets/logo/og-image.png">


    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Lora:wght@600&display=swap" rel="stylesheet">

    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --brand-red: #c8102e;
            --brand-red-dark: #a70d26;
            --brand-blue: #003893;
            --text-primary: #1a1a1a;
            --text-secondary: #555;
            --text-light: #888;
            --bg-main: #f4f4f4;
            --bg-card: #ffffff;
            --border-color: #dbdbdb;
            --success-color: #28a745;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --font-primary: 'Inter', sans-serif;
            --font-display: 'Lora', serif;
            --shadow-sm: 0 1px 2px rgba(0,0,0,0.06);
            --shadow-md: 0 4px 6px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 15px rgba(0,0,0,0.1);
            --header-height: 60px;
            --border-radius: 12px;
            --transition: all 0.3s ease;
        }

        /* GENERAL STYLES */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: var(--font-primary); line-height: 1.6; color: var(--text-primary); background-color: var(--bg-main); padding-top: var(--header-height); }
        .container { width: 100%; max-width: 1280px; margin: 0 auto; padding: 0 15px; }

        /* HEADER */
        header.main-header { background-color: rgba(255, 255, 255, 0.9); height: var(--header-height); position: fixed; top: 0; left: 0; width: 100%; z-index: 1000; border-bottom: 1px solid var(--border-color); display: flex; align-items: center; backdrop-filter: blur(10px); }
        .header-content { display: flex; justify-content: center; align-items: center; width: 100%; }
        .logo { font-family: var(--font-display); font-size: 1.8rem; font-weight: 600; color: var(--text-primary); text-decoration: none; }
        .logo span { color: var(--brand-red); }

        /* HERO SECTION */
        .hero-section { text-align: center; padding: 30px 0; }
        .hero-section h1 { font-family: var(--font-display); font-size: 2.2rem; margin-bottom: 12px; }
        .hero-section p { font-size: 1.1rem; color: var(--text-secondary); max-width: 550px; margin: 0 auto; }

        /* FILTERS */
        .filter-section { padding: 15px 0; margin-bottom: 25px; background-color: var(--bg-main); }
        .filter-bar { display: flex; gap: 10px; align-items: center; justify-content: flex-start; overflow-x: auto; padding: 5px 15px; scrollbar-width: none; -ms-overflow-style: none; margin: 0 -15px;}
        .filter-bar::-webkit-scrollbar { display: none; }
        .filter-button { background-color: var(--bg-card); border: 1px solid var(--border-color); color: var(--text-primary); padding: 8px 18px; border-radius: 50px; font-weight: 600; cursor: pointer; transition: var(--transition); font-size: 0.9rem; white-space: nowrap; flex-shrink: 0; }
        .filter-button:hover { border-color: var(--brand-red); color: var(--brand-red); }
        .filter-button.active { border-color: var(--brand-red); color: white; background-color: var(--brand-red); }

        /* EVENTS GRID & CARDS */
        .events-section { margin-bottom: 40px; }
        .events-grid { display: grid; grid-template-columns: 1fr; gap: 30px; max-width: 600px; margin: 0 auto; }
        .event-card { background-color: var(--bg-card); border-radius: 0; overflow: hidden; display: flex; flex-direction: column; position: relative; border: 1px solid var(--border-color); }
        
        .event-card-header { display: flex; align-items: center; padding: 12px 15px; }
        .organizer-logo { width: 40px; height: 40px; border-radius: 50%; background-color: var(--border-color); margin-right: 12px; font-size: 20px; display: flex; align-items: center; justify-content: center; font-weight: bold; color: var(--brand-red); }
        .organizer-info { font-weight: 600; }
        .verified-badge { color: var(--brand-blue); margin-left: 5px; }

        .event-image-container { position: relative; width: 100%; padding-top: 75%; /* 4:3 Aspect Ratio */ cursor: pointer; background-color: #eee; }
        .event-image { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-size: cover; background-position: center; }
        
        .event-actions { padding: 12px 15px; display: flex; gap: 20px; font-size: 1.5rem; }
        .action-icon { cursor: pointer; transition: color 0.2s, transform 0.2s; }
        .action-icon:hover { color: var(--text-light); }
        .action-icon:active { transform: scale(0.9); }
        .action-icon.saved { color: var(--brand-red); }
        
        .event-content { padding: 0 15px 20px; }
        .event-title { font-size: 1.1rem; font-weight: 600; margin-bottom: 12px; }
        .event-meta-item { display: flex; align-items: center; gap: 10px; font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 10px; }
        .event-meta-item i { color: var(--brand-red); width: 16px; text-align: center; }
        .event-meta-item .highlight { color: var(--text-primary); font-weight: 500; }
        .event-tags { margin-top: 15px; display: flex; flex-wrap: wrap; gap: 8px; }
        .event-tag { background-color: var(--bg-main); color: var(--text-secondary); padding: 5px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 500; }
        .details-link { display: inline-block; margin-top: 10px; color: var(--text-light); font-weight: 500; text-decoration: none; }

        /* SKELETON & EMPTY STATE */
        .skeleton-card { background-color: var(--bg-card); border: 1px solid var(--border-color); height: 600px; }
        .skeleton-image { height: 450px; } .skeleton { background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%); background-size: 200% 100%; animation: loading 1.5s infinite; }
        @keyframes loading { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }
        .empty-state { text-align: center; padding: 60px 20px; color: var(--text-secondary); } .empty-state i { font-size: 4rem; color: var(--border-color); margin-bottom: 20px; }

        /* EVENT DETAIL VIEW */
        #event-detail-view { padding: 20px 0; }
        .detail-card { background: var(--bg-card); box-shadow: none; overflow: hidden; }
        .detail-header { position: relative; height: 450px; background-color: #eee;}
        .detail-image { width: 100%; height: 100%; object-fit: cover; }
        .detail-header-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(to top, rgba(0,0,0,0.8) 20%, transparent 60%); display: flex; flex-direction: column; justify-content: flex-end; padding: 25px; }
        .detail-title { font-size: 2.2rem; font-weight: 700; color: white; text-shadow: 2px 2px 8px rgba(0,0,0,0.7); margin-bottom: 10px; }
        .detail-venue { font-size: 1.1rem; color: #eee; text-shadow: 1px 1px 4px rgba(0,0,0,0.7); }
        a.detail-venue-link { text-decoration: none; }
        .detail-body { padding: 25px; }
        .detail-main-content h3 { font-size: 1.3rem; margin-top: 15px; margin-bottom: 15px; border-bottom: 2px solid var(--brand-red); padding-bottom: 10px; }
        .detail-description p { margin-bottom: 1.2em; color: var(--text-secondary); line-height: 1.8; }
        .detail-meta-list { list-style: none; }
        .detail-meta-list li { display: flex; align-items: flex-start; gap: 15px; margin-bottom: 20px; font-size: 1rem; }
        .detail-meta-list i { color: var(--brand-red); font-size: 1.1rem; margin-top: 4px; width: 20px; }
        .detail-action-bar { padding: 15px 25px; border-top: 1px solid var(--border-color); }
        .action-btn.primary { display: flex; align-items: center; justify-content: center; gap: 10px; width: 100%; padding: 15px; font-size: 1.1rem; background-color: var(--brand-red); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; }
        .back-to-events-btn { display: inline-flex; align-items: center; gap: 8px; margin-bottom: 20px; background: transparent; border: none; font-size: 1.5rem; color: var(--text-primary); cursor: pointer; padding: 10px; }

        /* FOOTER */
        footer { text-align: center; padding: 40px 20px; background: var(--bg-main); color: var(--text-secondary); margin-top: 40px; border-top: 1px solid var(--border-color); }
        .footer-links { margin-top: 15px; }
        .footer-links a { margin: 0 12px; color: var(--text-secondary); font-size: 1.4rem; transition: var(--transition); } .footer-links a:hover { color: var(--brand-red); }
        .copyright { margin-top: 15px; opacity: 0.8; font-size: 0.9rem;}

        @media (min-width: 768px) {
            .event-card { border-radius: var(--border-radius); }
        }
    </style>
</head>
<body>
    <header class="main-header">
        <div class="container header-content">
            <a href="/" class="logo"><span>‡§ñ‡•ã</span>‡§ú‡•Å‡§Æ</a>
        </div>
    </header>

    <main class="container">
        <!-- Main Grid View (shown by default) -->
        <div id="main-grid-view">
            <section class="hero-section">
                <h1>What are you doing this week?</h1>
                <p>Discover the best events happening in Nepal. Your next great experience is just a click away.</p>
            </section>
            
            <div class="filter-section">
                <div class="filter-bar">
                    <button class="filter-button active" data-filter="all">All Events</button>
                    <button class="filter-button" data-filter="music">üéµ Music</button>
                    <button class="filter-button" data-filter="art">üé® Art</button>
                    <button class="filter-button" data-filter="business">üíº Business</button>
                    <button class="filter-button" data-filter="food">üçΩÔ∏è Food</button>
                    <button class="filter-button" data-filter="health">üí™ Health</button>
                    <button class="filter-button" data-filter="weekend">This Saturday</button>
                    <button class="filter-button" data-filter="free">Free Events</button>
                </div>
            </div>

            <section class="events-section">
                <div class="events-grid" id="events-container">
                    <!-- Event cards are rendered here by JS -->
                </div>
                
                <div class="empty-state" id="empty-state" style="display: none;">
                    <i class="fas fa-calendar-times"></i>
                    <h3>No events found</h3>
                    <p>Try adjusting your filters or search terms</p>
                </div>
            </section>
        </div>

        <!-- Event Detail View (hidden by default) -->
        <div id="event-detail-view" style="display: none;">
            <!-- Content for single event is rendered here by JS -->
        </div>
    </main>

    <footer>
        <div class="container">
            <p><strong>Go.Do.Feel.Repeat</strong> <a href="mailto:ceo@khojum.com?subject=Feedback" style="color: var(--text-primary); font-weight: 500;"></a></p>
            <div class="footer-links">
                <a href="https://www.instagram.com/khojum.comm?utm_source=ig_web_button_share_sheet&igsh=ZDNlZDc0MzIxNw==" target="_blank" title="Follow on Instagram">
                    <i class="fab fa-instagram"></i> 
                </a>

            </div>
            <p class="copyright">Khojum Inc. ¬© 2025</p>
        </div>
    </footer>
    
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const eventsData = [
            
            {
                id: 2,
                title: "John and The Locals Concert",
                date: "2025-07-12",
                time: "9:00 PM Onwards",
                venue: "XO Club, Thamel",
                price: "Rs. 1500",
                image: "assets/jhonconcert.png",
                category: "music",
                tags: ["Live Music", "Rock", "Nightlife"],
                organizer: { name: "XO Club", verified: false },
                description: "Experience an electrifying night of rock music with John and The Locals live in Thamel. Get ready for high-energy performances and unforgettable anthems.",
                bookingUrl: "https://events.khalti.com/events/ET259U4Z5ADC",
                actionText: "Get Tickets",
                actionIcon: "fa-ticket-alt"
            },
            {
                id: 3,
                title: "Interdependence: Art Exhibition",
                date: "2025-07-12",
                time: "11:00 AM - 5:00 PM",
                venue: "Nepal Art Council",
                price: "Free",
                image: "assets/artexhibiton.png",
                category: "art",
                tags: ["Exhibition", "Fine Arts", "Culture"],
                organizer: { name: "Nepal Art Council", verified: true },
                description: "An exploration of human connection through contemporary Nepali art and cultural expression. Featuring works from over 20 renowned and emerging artists.",
                bookingUrl: "https://vt.tiktok.com/ZSB2P4tYS/",
                actionText: "Learn More",
                actionIcon: "fa-info-circle"
            },
            {
                id: 4,
                title: "Artha Run Club",
                date: "Every Saturday",
                time: "6:00 AM",
                venue: "International Club, Lalitpur",
                price: "Free",
                image: "assets/runclub.png",
                category: "health",
                tags: ["Running", "Fitness", "Community"],
                organizer: { name: "Artha Group", verified: true },
                description: "All paces and ages are welcome, so bring your energy and your smiles! Come for the run, stay for the coffee, conversations, and connections after.",
                bookingUrl: "https://lu.ma/jb7oav4k",
                actionText: "Register Now",
                actionIcon: "fa-running"
            },
            {
                id: 6,
                title: "Benambari Theater Show",
                date: "2025-07-05",
                time: "12:00 PM and 4:00 PM",
                venue: "Mandala Theater, Thapagaun",
                price: "Rs. 350",
                image: "assets/benambari.png",
                category: "art",
                tags: ["Theater", "Performance", "Cultural"],
                organizer: { name: "Ace Theater club", verified: true },
                description: "Experience the captivating Benambari Theater Show at Mandala Theater. A must-see performance that showcases the rich cultural heritage of Nepal.",
                bookingUrl: "https://www.instagram.com/ace_theater_club?utm_source=ig_web_button_share_sheet&igsh=ZDNlZDc0MzIxNw==",
                actionText: "Get Tickets",
                actionIcon: "fa-ticket-alt"
            },
            {
                id: 8,
                title: "Rug Museum",
                date: "Everyday",
                time: "10 AM - 6 PM",
                venue: "Jan Kath, near Boudha",
                price: "Free",
                image: "assets/rugmuseum.png",
                category: "art",
                tags: ["Rugs", "Art", "Asthetic"],
                organizer: { name: "Rug Museum", verified: false },
                description: "Explore a variety of traditional and contemporary rugs showcasing the rich heritage of Nepal.",
                bookingUrl: "https://www.tiktok.com/@te4nz/video/7299830094464437505",
                actionText: "Learn More",
                actionIcon: "fa-info-circle"
            },
            {
                id: 5,
                title: "Tokha Saturday Mela",
                date: "2025-07-05",
                time: "3:00 PM - 7:00 PM",
                venue: "Tokha, near Ganesh Temple",
                price: "Free",
                image: "assets/tokhamela.png",
                category: "food",
                tags: ["Cultural", "Food Festival", "Newari Cuisine"],
                organizer: { name: "Local Community", verified: false },
                description: "Celebrate community and cuisine at Tokha's vibrant Saturday food and culture mela. Enjoy traditional Newari delicacies, live music, and local crafts.",
                bookingUrl: "https://www.tiktok.com/@storiesofmanisha/video/7474071111668600082",
                actionText: "View on TikTok",
                actionIcon: "fa-video"
            },
            {
                id: 7,
                title: "Kaiser Library",
                date: "Every Day",
                time: "9:00 AM - 5:00 PM",
                venue: "Kantipath",
                price: "Free",
                image: "assets/kaiserlibrary.png",
                category: "art",
                tags: ["Reading", "Quiet", "Productive"],
                organizer: { name: "Kaiser Library", verified: true },
                description: "Kaiser Library offers a serene environment to spend time and read books in the courtyard and inside the library. One of the rare gems of Nepal that most don't know about.",
                bookingUrl: "https://www.tiktok.com/@adorrree_me/video/7493883616259296520",
                actionText: "Learn More",
                actionIcon: "fa-info-circle"
            },
            {
                id: 1,
                title: "Shark Tank Nepal - Season 1",
                date: "2025-07-08",
                time: "9:00 PM",
                venue: "Himalayan TV HD",
                price: "Free",
                image: "assets/sharktank.png",
                category: "business",
                tags: ["TV Show", "Startups", "Investment"],
                organizer: { name: "Himalayan TV", verified: true },
                description: "Watch entrepreneurs pitch their ideas to celebrity investors on national television. This season promises bigger deals, tougher negotiations, and groundbreaking innovations.",
                bookingUrl: "https://www.youtube.com/watch?v=bp4NDX-WMlA",
                actionText: "Watch on YouTube",
                actionIcon: "fa-play-circle"
            },
        ];

        let currentFilter = 'all';
        let savedEvents = new Set();
        
        const mainGridView = document.getElementById('main-grid-view');
        const eventDetailView = document.getElementById('event-detail-view');
        const eventsContainer = document.getElementById('events-container');
        const emptyState = document.getElementById('empty-state');
        const filterButtons = document.querySelectorAll('.filter-button');

        function init() {
            setupEventListeners();
            handleRouting();
            window.addEventListener('hashchange', handleRouting);
        }

        function handleRouting() {
            const hash = window.location.hash;
            if (hash.startsWith('#event-')) {
                const eventId = parseInt(hash.substring('#event-'.length), 10);
                showDetailPage(eventId);
            } else {
                showGridView();
            }
        }
        
        function updateMetaTags(title, description, imageUrl, url) {
            document.title = title;
            document.querySelector('meta[name="title"]').setAttribute("content", title);
            document.querySelector('meta[property="og:title"]').setAttribute("content", title);
            document.querySelector('meta[name="twitter:title"]').setAttribute("content", title);

            document.querySelector('meta[name="description"]').setAttribute("content", description);
            document.querySelector('meta[property="og:description"]').setAttribute("content", description);
            document.querySelector('meta[name="twitter:description"]').setAttribute("content", description);

            document.querySelector('meta[property="og:image"]').setAttribute("content", imageUrl);
            document.querySelector('meta[name="twitter:image"]').setAttribute("content", imageUrl);
            
            document.querySelector('meta[property="og:url"]').setAttribute("content", url);
            document.querySelector('link[rel="canonical"]').setAttribute("href", url);
        }

        function showGridView() {
            mainGridView.style.display = 'block';
            eventDetailView.style.display = 'none';
            if (window.location.hash) {
                history.pushState("", document.title, window.location.pathname + window.location.search);
            }
            updateMetaTags(
                "Discover Events in Nepal | Khojum.com",
                "Nepal's top event discovery platform for concerts, festivals, art exhibitions, and workshops in Kathmandu and beyond. Your guide to what's happening.",
                "https://khojum.com/assets/logo/og-image.png",
                "https://khojum.com"
            );
            applyFilters();
        }

        function showDetailPage(eventId) {
            const event = eventsData.find(e => e.id === eventId);
            mainGridView.style.display = 'none';
            eventDetailView.style.display = 'block';
            window.scrollTo(0, 0);

            if (!event) {
                eventDetailView.innerHTML = `<div class="empty-state"><h3>Event Not Found</h3><p>The event you are looking for does not exist.</p><button class="back-to-events-btn" onclick="window.location.hash=''">Back to All Events</button></div>`;
                return;
            }
            
            const eventUrl = `${window.location.origin}${window.location.pathname}#event-${event.id}`;
            const imageUrl = `${window.location.origin}/${event.image}`;

            updateMetaTags(
                `${event.title} | Khojum.com`,
                event.description.substring(0, 160) + '...',
                imageUrl,
                eventUrl
            );

            const formattedDate = formatEventDate(event.date, { weekday: 'long', month: 'long', day: 'numeric' });
            const actionIcon = event.actionIcon || 'fa-ticket-alt';
            const actionText = event.actionText || 'Get Tickets';
            
            eventDetailView.innerHTML = `
                <button class="back-to-events-btn" onclick="window.location.hash=''"><i class="fas fa-arrow-left"></i></button>
                <div class="detail-card">
                    <header class="detail-header">
                        <img src="${event.image}" alt="${event.title}" class="detail-image">
                        <div class="detail-header-overlay">
                            <h1 class="detail-title">${event.title}</h1>
                            <a href="${event.gmapsUrl || '#'}" target="_blank" rel="noopener noreferrer" class="detail-venue-link">
                                <p class="detail-venue"><i class="fas fa-map-marker-alt"></i> ${event.venue}</p>
                            </a>
                        </div>
                    </header>
                    <div class="detail-body">
                         <ul class="detail-meta-list">
                            <li><i class="fas fa-calendar-day"></i><div><strong>Date:</strong><br>${formattedDate}</div></li>
                            <li><i class="fas fa-clock"></i><div><strong>Time:</strong><br>${event.time}</div></li>
                            <li><i class="fas fa-ticket-alt"></i><div><strong>Price:</strong><br>${event.price}</div></li>
                            <li><i class="fas fa-building"></i><div><strong>Organizer:</strong><br>${event.organizer.name} ${event.organizer.verified ? '<i class="fas fa-check-circle verified-badge"></i>' : ''}</div></li>
                        </ul>

                        <div class="detail-main-content">
                            <h3>About the Event</h3>
                            <div class="detail-description"><p>${event.description.replace(/<br>/g, '</p><p>').replace(/\\n/g, '</p><p>')}</p></div>
                        </div>
                    </div>
                    <div class="detail-action-bar">
                         <button class="action-btn primary" onclick="bookTicket(event, ${event.id})">
                            <i class="fas ${actionIcon}"></i> ${actionText}
                        </button>
                    </div>
                </div>
            `;
        }
        
        function setupEventListeners() {
            filterButtons.forEach(button => {
                button.addEventListener('click', () => {
                    filterButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    currentFilter = button.dataset.filter;
                    applyFilters();
                });
            });
        }

        function applyFilters() {
            showLoadingState();
            setTimeout(() => {
                let filteredEvents = eventsData;
                if (currentFilter !== 'all') {
                    if (currentFilter === 'weekend') {
                        const weekendDates = getWeekendDates();
                        filteredEvents = filteredEvents.filter(event => weekendDates.includes(event.date));
                    } else if (currentFilter === 'free') {
                        filteredEvents = filteredEvents.filter(event => event.price.toLowerCase().includes('free'));
                    } else {
                        filteredEvents = filteredEvents.filter(event => event.category.toLowerCase() === currentFilter);
                    }
                }
                renderEvents(filteredEvents);
            }, 200);
        }

        function renderEvents(events) {
            hideLoadingState();
            emptyState.style.display = events.length === 0 ? 'block' : 'none';
            eventsContainer.innerHTML = events.map(event => createEventCard(event)).join('');
        }

        function createEventCard(event) {
            const formattedDate = formatEventDate(event.date, { weekday: 'short', month: 'short', day: 'numeric' });
            const organizerInitial = event.organizer.name.charAt(0).toUpperCase();

            return `
                <div class="event-card">
                    <div class="event-card-header">
                        <div class="organizer-logo">${organizerInitial}</div>
                        <div class="organizer-info">
                            ${event.organizer.name}
                            ${event.organizer.verified ? '<i class="fas fa-check-circle verified-badge"></i>' : ''}
                        </div>
                    </div>
                    <div class="event-image-container" onclick="viewDetails(event, ${event.id})">
                        <div class="event-image" style="background-image: url('${event.image}')"></div>
                    </div>
                    <div class="event-actions">
                        <i class="action-icon fas fa-heart ${savedEvents.has(event.id) ? 'saved' : ''}" onclick="toggleSave(event, ${event.id})"></i>
                        <i class="action-icon fas fa-share-alt" onclick="shareEvent(event, ${event.id})"></i>
                    </div>
                    <div class="event-content">
                        <h3 class="event-title">${event.title}</h3>
                        <div class="event-meta-item">
                            <i class="fas fa-calendar-alt"></i><span class="highlight">${formattedDate}</span> at ${event.time}
                        </div>
                        <div class="event-meta-item">
                            <i class="fas fa-map-marker-alt"></i><span class="highlight">${event.venue}</span>
                        </div>
                        <a href="#event-${event.id}" class="details-link" onclick="viewDetails(event, ${event.id})">View details...</a>
                    </div>
                </div>
            `;
        }

        // --- Global Functions for onclick Handlers ---
        window.toggleSave = (e, eventId) => { e.stopPropagation(); const icon = e.currentTarget; savedEvents.has(eventId) ? (savedEvents.delete(eventId), icon.classList.remove('saved')) : (savedEvents.add(eventId), icon.classList.add('saved')); };
        window.shareEvent = (e, eventId) => { 
            e.stopPropagation(); 
            const event = eventsData.find(ev => ev.id === eventId);
            const url = `${window.location.origin}${window.location.pathname}#event-${eventId}`;
            if (navigator.share) {
                navigator.share({
                    title: event.title,
                    text: `Check out this event on Khojum: ${event.title}`,
                    url: url,
                }).catch((error) => console.log('Error sharing', error));
            } else {
                navigator.clipboard.writeText(url).then(() => showNotification('Event link copied!'));
            }
        };
        window.viewDetails = (e, eventId) => { 
            e.preventDefault();
            window.location.hash = `#event-${eventId}`; 
        };
        window.bookTicket = (e, eventId) => { 
            e.stopPropagation(); 
            const event = eventsData.find(ev => ev.id === eventId); 
            if (event && event.bookingUrl) window.open(event.bookingUrl, '_blank');
            else { showNotification('Booking information not available.', 'info'); }
        };

        // --- Helper Functions ---
        function formatEventDate(dateString, formatOptions) {
            if (/^\d{4}-\d{2}-\d{2}$/.test(dateString)) {
                const dt = new Date(dateString);
                const adjustedDate = new Date(dt.valueOf() + dt.getTimezoneOffset() * 60 * 1000);
                return adjustedDate.toLocaleDateString('en-US', formatOptions);
            }
            return dateString;
        }
        const getWeekendDates = () => { const today = new Date(); const sat = new Date(today); sat.setDate(today.getDate() + (6 - today.getDay() + 7) % 7); return [sat.toISOString().split('T')[0]]; };
        const showLoadingState = () => { eventsContainer.innerHTML = Array(3).fill('<div class="skeleton-card"><div class="skeleton-image skeleton"></div></div>').join(''); };
        const hideLoadingState = () => { eventsContainer.innerHTML = ''; };
        function showNotification(message, type = 'info') { const el = document.createElement('div'); el.style.cssText = `position:fixed;bottom:20px;left:50%;transform:translateX(-50%);padding:12px 20px;border-radius:8px;z-index:10000;font-weight:500;transition:all .3s ease;opacity:0;background:${type==='error'?'#dc3545':'#28a745'};color:white;box-shadow: var(--shadow-md);`; el.textContent = message; document.body.appendChild(el); setTimeout(() => {el.style.opacity = 1; el.style.bottom = '30px';}, 10); setTimeout(() => { el.style.opacity = 0; el.style.bottom = '20px'; setTimeout(() => el.remove(), 300); }, 3000); }

        init();
    });
    </script>
</body>
</html>
